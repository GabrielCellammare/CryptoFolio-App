

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Welcome to Project Documentation of CryptoFolio &mdash; CryptoFolio  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#" class="icon icon-home">
            CryptoFolio
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Welcome to Project Documentation of CryptoFolio</a><ul>
<li><a class="reference internal" href="#contents">Contents</a></li>
<li><a class="reference internal" href="#detailed-module-documentation">Detailed Module Documentation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#app">app</a></li>
<li><a class="reference internal" href="#module-configuration.config">configuration.config</a><ul>
<li><a class="reference internal" href="#configuration.config.SecurityError"><code class="docutils literal notranslate"><span class="pre">SecurityError</span></code></a></li>
<li><a class="reference internal" href="#configuration.config.ConfigurationError"><code class="docutils literal notranslate"><span class="pre">ConfigurationError</span></code></a></li>
<li><a class="reference internal" href="#configuration.config.SecurityHeaders"><code class="docutils literal notranslate"><span class="pre">SecurityHeaders</span></code></a><ul>
<li><a class="reference internal" href="#configuration.config.SecurityHeaders.HSTS"><code class="docutils literal notranslate"><span class="pre">SecurityHeaders.HSTS</span></code></a></li>
<li><a class="reference internal" href="#configuration.config.SecurityHeaders.CONTENT_TYPE_OPTIONS"><code class="docutils literal notranslate"><span class="pre">SecurityHeaders.CONTENT_TYPE_OPTIONS</span></code></a></li>
<li><a class="reference internal" href="#configuration.config.SecurityHeaders.FRAME_OPTIONS"><code class="docutils literal notranslate"><span class="pre">SecurityHeaders.FRAME_OPTIONS</span></code></a></li>
<li><a class="reference internal" href="#configuration.config.SecurityHeaders.XSS_PROTECTION"><code class="docutils literal notranslate"><span class="pre">SecurityHeaders.XSS_PROTECTION</span></code></a></li>
<li><a class="reference internal" href="#configuration.config.SecurityHeaders.REFERRER_POLICY"><code class="docutils literal notranslate"><span class="pre">SecurityHeaders.REFERRER_POLICY</span></code></a></li>
<li><a class="reference internal" href="#configuration.config.SecurityHeaders.PERMITTED_CROSS_DOMAIN_POLICIES"><code class="docutils literal notranslate"><span class="pre">SecurityHeaders.PERMITTED_CROSS_DOMAIN_POLICIES</span></code></a></li>
<li><a class="reference internal" href="#configuration.config.SecurityHeaders.CSP"><code class="docutils literal notranslate"><span class="pre">SecurityHeaders.CSP</span></code></a></li>
<li><a class="reference internal" href="#configuration.config.SecurityHeaders.__init__"><code class="docutils literal notranslate"><span class="pre">SecurityHeaders.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#configuration.config.EnvironmentConfig"><code class="docutils literal notranslate"><span class="pre">EnvironmentConfig</span></code></a><ul>
<li><a class="reference internal" href="#configuration.config.EnvironmentConfig.origins"><code class="docutils literal notranslate"><span class="pre">EnvironmentConfig.origins</span></code></a></li>
<li><a class="reference internal" href="#configuration.config.EnvironmentConfig.max_requests"><code class="docutils literal notranslate"><span class="pre">EnvironmentConfig.max_requests</span></code></a></li>
<li><a class="reference internal" href="#configuration.config.EnvironmentConfig.request_window"><code class="docutils literal notranslate"><span class="pre">EnvironmentConfig.request_window</span></code></a></li>
<li><a class="reference internal" href="#configuration.config.EnvironmentConfig.__init__"><code class="docutils literal notranslate"><span class="pre">EnvironmentConfig.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#configuration.config.SecureConfig"><code class="docutils literal notranslate"><span class="pre">SecureConfig</span></code></a><ul>
<li><a class="reference internal" href="#configuration.config.SecureConfig.DEFAULT_CORS_MAX_AGE"><code class="docutils literal notranslate"><span class="pre">SecureConfig.DEFAULT_CORS_MAX_AGE</span></code></a></li>
<li><a class="reference internal" href="#configuration.config.SecureConfig.DEFAULT_HSTS_MAX_AGE"><code class="docutils literal notranslate"><span class="pre">SecureConfig.DEFAULT_HSTS_MAX_AGE</span></code></a></li>
<li><a class="reference internal" href="#configuration.config.SecureConfig.SUPPORTED_ENVIRONMENTS"><code class="docutils literal notranslate"><span class="pre">SecureConfig.SUPPORTED_ENVIRONMENTS</span></code></a></li>
<li><a class="reference internal" href="#configuration.config.SecureConfig.ORIGIN_PATTERN"><code class="docutils literal notranslate"><span class="pre">SecureConfig.ORIGIN_PATTERN</span></code></a></li>
<li><a class="reference internal" href="#configuration.config.SecureConfig.__init__"><code class="docutils literal notranslate"><span class="pre">SecureConfig.__init__()</span></code></a></li>
<li><a class="reference internal" href="#configuration.config.SecureConfig.initialize_app"><code class="docutils literal notranslate"><span class="pre">SecureConfig.initialize_app()</span></code></a></li>
<li><a class="reference internal" href="#configuration.config.SecureConfig.get_allowed_origins"><code class="docutils literal notranslate"><span class="pre">SecureConfig.get_allowed_origins()</span></code></a></li>
<li><a class="reference internal" href="#configuration.config.SecureConfig.add_security_headers"><code class="docutils literal notranslate"><span class="pre">SecureConfig.add_security_headers()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-configuration.init_app">configuration.init_app</a><ul>
<li><a class="reference internal" href="#configuration.init_app.validate_environment_variables"><code class="docutils literal notranslate"><span class="pre">validate_environment_variables()</span></code></a></li>
<li><a class="reference internal" href="#configuration.init_app.validate_secret_key"><code class="docutils literal notranslate"><span class="pre">validate_secret_key()</span></code></a></li>
<li><a class="reference internal" href="#configuration.init_app.secure_firebase_init"><code class="docutils literal notranslate"><span class="pre">secure_firebase_init()</span></code></a></li>
<li><a class="reference internal" href="#configuration.init_app.create_app"><code class="docutils literal notranslate"><span class="pre">create_app()</span></code></a></li>
<li><a class="reference internal" href="#configuration.init_app.configure_development_environment"><code class="docutils literal notranslate"><span class="pre">configure_development_environment()</span></code></a></li>
<li><a class="reference internal" href="#configuration.init_app.configure_oauth"><code class="docutils literal notranslate"><span class="pre">configure_oauth()</span></code></a></li>
<li><a class="reference internal" href="#configuration.init_app.determine_callback_base_url"><code class="docutils literal notranslate"><span class="pre">determine_callback_base_url()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-configuration.ngrok_manager">configuration.ngrok_manager</a><ul>
<li><a class="reference internal" href="#configuration.ngrok_manager.NgrokManager"><code class="docutils literal notranslate"><span class="pre">NgrokManager</span></code></a><ul>
<li><a class="reference internal" href="#configuration.ngrok_manager.NgrokManager.__init__"><code class="docutils literal notranslate"><span class="pre">NgrokManager.__init__()</span></code></a></li>
<li><a class="reference internal" href="#configuration.ngrok_manager.NgrokManager.init_app"><code class="docutils literal notranslate"><span class="pre">NgrokManager.init_app()</span></code></a></li>
<li><a class="reference internal" href="#configuration.ngrok_manager.NgrokManager.start_tunnel"><code class="docutils literal notranslate"><span class="pre">NgrokManager.start_tunnel()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-doc_generator">doc_generator</a><ul>
<li><a class="reference internal" href="#doc_generator.DocGenerator"><code class="docutils literal notranslate"><span class="pre">DocGenerator</span></code></a><ul>
<li><a class="reference internal" href="#doc_generator.DocGenerator.project_dir"><code class="docutils literal notranslate"><span class="pre">DocGenerator.project_dir</span></code></a></li>
<li><a class="reference internal" href="#doc_generator.DocGenerator.output_dir"><code class="docutils literal notranslate"><span class="pre">DocGenerator.output_dir</span></code></a></li>
<li><a class="reference internal" href="#doc_generator.DocGenerator.has_rtd_theme"><code class="docutils literal notranslate"><span class="pre">DocGenerator.has_rtd_theme</span></code></a></li>
<li><a class="reference internal" href="#doc_generator.DocGenerator.python_files"><code class="docutils literal notranslate"><span class="pre">DocGenerator.python_files</span></code></a></li>
<li><a class="reference internal" href="#doc_generator.DocGenerator.__init__"><code class="docutils literal notranslate"><span class="pre">DocGenerator.__init__()</span></code></a></li>
<li><a class="reference internal" href="#doc_generator.DocGenerator.setup_sphinx"><code class="docutils literal notranslate"><span class="pre">DocGenerator.setup_sphinx()</span></code></a></li>
<li><a class="reference internal" href="#doc_generator.DocGenerator.generate_sphinx_docs"><code class="docutils literal notranslate"><span class="pre">DocGenerator.generate_sphinx_docs()</span></code></a></li>
<li><a class="reference internal" href="#doc_generator.DocGenerator.generate_pdoc_docs"><code class="docutils literal notranslate"><span class="pre">DocGenerator.generate_pdoc_docs()</span></code></a></li>
<li><a class="reference internal" href="#doc_generator.DocGenerator.run"><code class="docutils literal notranslate"><span class="pre">DocGenerator.run()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#doc_generator.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-security.cryptography.cryptography_utils">security.cryptography.cryptography_utils</a><ul>
<li><a class="reference internal" href="#security.cryptography.cryptography_utils.CryptographicError"><code class="docutils literal notranslate"><span class="pre">CryptographicError</span></code></a></li>
<li><a class="reference internal" href="#security.cryptography.cryptography_utils.AESCipher"><code class="docutils literal notranslate"><span class="pre">AESCipher</span></code></a><ul>
<li><a class="reference internal" href="#security.cryptography.cryptography_utils.AESCipher.BLOCK_SIZE"><code class="docutils literal notranslate"><span class="pre">AESCipher.BLOCK_SIZE</span></code></a></li>
<li><a class="reference internal" href="#security.cryptography.cryptography_utils.AESCipher.KEY_LENGTH"><code class="docutils literal notranslate"><span class="pre">AESCipher.KEY_LENGTH</span></code></a></li>
<li><a class="reference internal" href="#security.cryptography.cryptography_utils.AESCipher.IV_LENGTH"><code class="docutils literal notranslate"><span class="pre">AESCipher.IV_LENGTH</span></code></a></li>
<li><a class="reference internal" href="#security.cryptography.cryptography_utils.AESCipher.SALT_LENGTH"><code class="docutils literal notranslate"><span class="pre">AESCipher.SALT_LENGTH</span></code></a></li>
<li><a class="reference internal" href="#security.cryptography.cryptography_utils.AESCipher.KDF_ITERATIONS"><code class="docutils literal notranslate"><span class="pre">AESCipher.KDF_ITERATIONS</span></code></a></li>
<li><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">AESCipher.BLOCK_SIZE</span></code></a></li>
<li><a class="reference internal" href="#id1"><code class="docutils literal notranslate"><span class="pre">AESCipher.KEY_LENGTH</span></code></a></li>
<li><a class="reference internal" href="#id2"><code class="docutils literal notranslate"><span class="pre">AESCipher.IV_LENGTH</span></code></a></li>
<li><a class="reference internal" href="#id3"><code class="docutils literal notranslate"><span class="pre">AESCipher.SALT_LENGTH</span></code></a></li>
<li><a class="reference internal" href="#id4"><code class="docutils literal notranslate"><span class="pre">AESCipher.KDF_ITERATIONS</span></code></a></li>
<li><a class="reference internal" href="#security.cryptography.cryptography_utils.AESCipher.__init__"><code class="docutils literal notranslate"><span class="pre">AESCipher.__init__()</span></code></a></li>
<li><a class="reference internal" href="#security.cryptography.cryptography_utils.AESCipher.hash_user_id"><code class="docutils literal notranslate"><span class="pre">AESCipher.hash_user_id()</span></code></a></li>
<li><a class="reference internal" href="#security.cryptography.cryptography_utils.AESCipher.verify_user_id_hash"><code class="docutils literal notranslate"><span class="pre">AESCipher.verify_user_id_hash()</span></code></a></li>
<li><a class="reference internal" href="#security.cryptography.cryptography_utils.AESCipher.generate_salt"><code class="docutils literal notranslate"><span class="pre">AESCipher.generate_salt()</span></code></a></li>
<li><a class="reference internal" href="#security.cryptography.cryptography_utils.AESCipher.derive_key"><code class="docutils literal notranslate"><span class="pre">AESCipher.derive_key()</span></code></a></li>
<li><a class="reference internal" href="#security.cryptography.cryptography_utils.AESCipher.encrypt"><code class="docutils literal notranslate"><span class="pre">AESCipher.encrypt()</span></code></a></li>
<li><a class="reference internal" href="#security.cryptography.cryptography_utils.AESCipher.decrypt"><code class="docutils literal notranslate"><span class="pre">AESCipher.decrypt()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-security.cryptography.portfolio_encryption">security.cryptography.portfolio_encryption</a><ul>
<li><a class="reference internal" href="#security.cryptography.portfolio_encryption.PortfolioEncryptionError"><code class="docutils literal notranslate"><span class="pre">PortfolioEncryptionError</span></code></a></li>
<li><a class="reference internal" href="#security.cryptography.portfolio_encryption.PortfolioEncryption"><code class="docutils literal notranslate"><span class="pre">PortfolioEncryption</span></code></a><ul>
<li><a class="reference internal" href="#security.cryptography.portfolio_encryption.PortfolioEncryption.SENSITIVE_FIELDS"><code class="docutils literal notranslate"><span class="pre">PortfolioEncryption.SENSITIVE_FIELDS</span></code></a></li>
<li><a class="reference internal" href="#security.cryptography.portfolio_encryption.PortfolioEncryption.SECURE_MEMORY_WIPE_PASSES"><code class="docutils literal notranslate"><span class="pre">PortfolioEncryption.SECURE_MEMORY_WIPE_PASSES</span></code></a></li>
<li><a class="reference internal" href="#security.cryptography.portfolio_encryption.PortfolioEncryption.DEFAULT_NUMERIC_VALUE"><code class="docutils literal notranslate"><span class="pre">PortfolioEncryption.DEFAULT_NUMERIC_VALUE</span></code></a></li>
<li><a class="reference internal" href="#security.cryptography.portfolio_encryption.PortfolioEncryption.DEFAULT_STRING_VALUE"><code class="docutils literal notranslate"><span class="pre">PortfolioEncryption.DEFAULT_STRING_VALUE</span></code></a></li>
<li><a class="reference internal" href="#security.cryptography.portfolio_encryption.PortfolioEncryption.logger"><code class="docutils literal notranslate"><span class="pre">PortfolioEncryption.logger</span></code></a></li>
<li><a class="reference internal" href="#security.cryptography.portfolio_encryption.PortfolioEncryption.__init__"><code class="docutils literal notranslate"><span class="pre">PortfolioEncryption.__init__()</span></code></a></li>
<li><a class="reference internal" href="#security.cryptography.portfolio_encryption.PortfolioEncryption.encrypt_portfolio_item"><code class="docutils literal notranslate"><span class="pre">PortfolioEncryption.encrypt_portfolio_item()</span></code></a></li>
<li><a class="reference internal" href="#security.cryptography.portfolio_encryption.PortfolioEncryption.decrypt_portfolio_item"><code class="docutils literal notranslate"><span class="pre">PortfolioEncryption.decrypt_portfolio_item()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-security.csrf_protection">security.csrf_protection</a><ul>
<li><a class="reference internal" href="#security.csrf_protection.CSRFProtection"><code class="docutils literal notranslate"><span class="pre">CSRFProtection</span></code></a><ul>
<li><a class="reference internal" href="#security.csrf_protection.CSRFProtection.__init__"><code class="docutils literal notranslate"><span class="pre">CSRFProtection.__init__()</span></code></a></li>
<li><a class="reference internal" href="#security.csrf_protection.CSRFProtection.init_app"><code class="docutils literal notranslate"><span class="pre">CSRFProtection.init_app()</span></code></a></li>
<li><a class="reference internal" href="#security.csrf_protection.CSRFProtection.set_csrf_cookie"><code class="docutils literal notranslate"><span class="pre">CSRFProtection.set_csrf_cookie()</span></code></a></li>
<li><a class="reference internal" href="#security.csrf_protection.CSRFProtection.generate_token"><code class="docutils literal notranslate"><span class="pre">CSRFProtection.generate_token()</span></code></a></li>
<li><a class="reference internal" href="#security.csrf_protection.CSRFProtection.validate_token_request"><code class="docutils literal notranslate"><span class="pre">CSRFProtection.validate_token_request()</span></code></a></li>
<li><a class="reference internal" href="#security.csrf_protection.CSRFProtection.generate_nonce"><code class="docutils literal notranslate"><span class="pre">CSRFProtection.generate_nonce()</span></code></a></li>
<li><a class="reference internal" href="#security.csrf_protection.CSRFProtection.validate_nonce"><code class="docutils literal notranslate"><span class="pre">CSRFProtection.validate_nonce()</span></code></a></li>
<li><a class="reference internal" href="#security.csrf_protection.CSRFProtection.csrf_protect"><code class="docutils literal notranslate"><span class="pre">CSRFProtection.csrf_protect()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-security.input_validator">security.input_validator</a><ul>
<li><a class="reference internal" href="#security.input_validator.ValidationError"><code class="docutils literal notranslate"><span class="pre">ValidationError</span></code></a><ul>
<li><a class="reference internal" href="#security.input_validator.ValidationError.__init__"><code class="docutils literal notranslate"><span class="pre">ValidationError.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#security.input_validator.InputType"><code class="docutils literal notranslate"><span class="pre">InputType</span></code></a><ul>
<li><a class="reference internal" href="#security.input_validator.InputType.STRING"><code class="docutils literal notranslate"><span class="pre">InputType.STRING</span></code></a></li>
<li><a class="reference internal" href="#security.input_validator.InputType.NUMBER"><code class="docutils literal notranslate"><span class="pre">InputType.NUMBER</span></code></a></li>
<li><a class="reference internal" href="#security.input_validator.InputType.DATE"><code class="docutils literal notranslate"><span class="pre">InputType.DATE</span></code></a></li>
<li><a class="reference internal" href="#security.input_validator.InputType.EMAIL"><code class="docutils literal notranslate"><span class="pre">InputType.EMAIL</span></code></a></li>
<li><a class="reference internal" href="#security.input_validator.InputType.URL"><code class="docutils literal notranslate"><span class="pre">InputType.URL</span></code></a></li>
<li><a class="reference internal" href="#security.input_validator.InputType.CRYPTO_ID"><code class="docutils literal notranslate"><span class="pre">InputType.CRYPTO_ID</span></code></a></li>
<li><a class="reference internal" href="#security.input_validator.InputType.CURRENCY"><code class="docutils literal notranslate"><span class="pre">InputType.CURRENCY</span></code></a></li>
<li><a class="reference internal" href="#security.input_validator.InputType.JWT"><code class="docutils literal notranslate"><span class="pre">InputType.JWT</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#security.input_validator.ValidationRule"><code class="docutils literal notranslate"><span class="pre">ValidationRule</span></code></a><ul>
<li><a class="reference internal" href="#security.input_validator.ValidationRule.required"><code class="docutils literal notranslate"><span class="pre">ValidationRule.required</span></code></a></li>
<li><a class="reference internal" href="#security.input_validator.ValidationRule.type"><code class="docutils literal notranslate"><span class="pre">ValidationRule.type</span></code></a></li>
<li><a class="reference internal" href="#security.input_validator.ValidationRule.min_length"><code class="docutils literal notranslate"><span class="pre">ValidationRule.min_length</span></code></a></li>
<li><a class="reference internal" href="#security.input_validator.ValidationRule.max_length"><code class="docutils literal notranslate"><span class="pre">ValidationRule.max_length</span></code></a></li>
<li><a class="reference internal" href="#security.input_validator.ValidationRule.min_value"><code class="docutils literal notranslate"><span class="pre">ValidationRule.min_value</span></code></a></li>
<li><a class="reference internal" href="#security.input_validator.ValidationRule.max_value"><code class="docutils literal notranslate"><span class="pre">ValidationRule.max_value</span></code></a></li>
<li><a class="reference internal" href="#security.input_validator.ValidationRule.pattern"><code class="docutils literal notranslate"><span class="pre">ValidationRule.pattern</span></code></a></li>
<li><a class="reference internal" href="#security.input_validator.ValidationRule.allowed_values"><code class="docutils literal notranslate"><span class="pre">ValidationRule.allowed_values</span></code></a></li>
<li><a class="reference internal" href="#security.input_validator.ValidationRule.custom_validator"><code class="docutils literal notranslate"><span class="pre">ValidationRule.custom_validator</span></code></a></li>
<li><a class="reference internal" href="#security.input_validator.ValidationRule.__init__"><code class="docutils literal notranslate"><span class="pre">ValidationRule.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#security.input_validator.InputValidator"><code class="docutils literal notranslate"><span class="pre">InputValidator</span></code></a><ul>
<li><a class="reference internal" href="#security.input_validator.InputValidator.PATTERNS"><code class="docutils literal notranslate"><span class="pre">InputValidator.PATTERNS</span></code></a></li>
<li><a class="reference internal" href="#security.input_validator.InputValidator.COMMON_RULES"><code class="docutils literal notranslate"><span class="pre">InputValidator.COMMON_RULES</span></code></a></li>
<li><a class="reference internal" href="#security.input_validator.InputValidator.MIN_ALLOWED_DATE"><code class="docutils literal notranslate"><span class="pre">InputValidator.MIN_ALLOWED_DATE</span></code></a></li>
<li><a class="reference internal" href="#security.input_validator.InputValidator.sanitize_input"><code class="docutils literal notranslate"><span class="pre">InputValidator.sanitize_input()</span></code></a></li>
<li><a class="reference internal" href="#security.input_validator.InputValidator.validate_value"><code class="docutils literal notranslate"><span class="pre">InputValidator.validate_value()</span></code></a></li>
<li><a class="reference internal" href="#security.input_validator.InputValidator.validate_request_data"><code class="docutils literal notranslate"><span class="pre">InputValidator.validate_request_data()</span></code></a></li>
<li><a class="reference internal" href="#security.input_validator.InputValidator.validate_portfolio_add"><code class="docutils literal notranslate"><span class="pre">InputValidator.validate_portfolio_add()</span></code></a></li>
<li><a class="reference internal" href="#security.input_validator.InputValidator.validate_auth"><code class="docutils literal notranslate"><span class="pre">InputValidator.validate_auth()</span></code></a></li>
<li><a class="reference internal" href="#security.input_validator.InputValidator.validate_currency_preference"><code class="docutils literal notranslate"><span class="pre">InputValidator.validate_currency_preference()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-security.rate_limiter">security.rate_limiter</a><ul>
<li><a class="reference internal" href="#security.rate_limiter.FirebaseRateLimitCleaner"><code class="docutils literal notranslate"><span class="pre">FirebaseRateLimitCleaner</span></code></a><ul>
<li><a class="reference internal" href="#security.rate_limiter.FirebaseRateLimitCleaner.__init__"><code class="docutils literal notranslate"><span class="pre">FirebaseRateLimitCleaner.__init__()</span></code></a></li>
<li><a class="reference internal" href="#security.rate_limiter.FirebaseRateLimitCleaner.clean_expired_entries"><code class="docutils literal notranslate"><span class="pre">FirebaseRateLimitCleaner.clean_expired_entries()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#security.rate_limiter.FirebaseRateLimiter"><code class="docutils literal notranslate"><span class="pre">FirebaseRateLimiter</span></code></a><ul>
<li><a class="reference internal" href="#security.rate_limiter.FirebaseRateLimiter.__init__"><code class="docutils literal notranslate"><span class="pre">FirebaseRateLimiter.__init__()</span></code></a></li>
<li><a class="reference internal" href="#security.rate_limiter.FirebaseRateLimiter.maybe_cleanup"><code class="docutils literal notranslate"><span class="pre">FirebaseRateLimiter.maybe_cleanup()</span></code></a></li>
<li><a class="reference internal" href="#security.rate_limiter.FirebaseRateLimiter.check_rate_limit"><code class="docutils literal notranslate"><span class="pre">FirebaseRateLimiter.check_rate_limit()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-security.secure_bye_array">security.secure_bye_array</a><ul>
<li><a class="reference internal" href="#security.secure_bye_array.MemorySecurityError"><code class="docutils literal notranslate"><span class="pre">MemorySecurityError</span></code></a></li>
<li><a class="reference internal" href="#security.secure_bye_array.SecureByteArray"><code class="docutils literal notranslate"><span class="pre">SecureByteArray</span></code></a><ul>
<li><a class="reference internal" href="#security.secure_bye_array.SecureByteArray.logger"><code class="docutils literal notranslate"><span class="pre">SecureByteArray.logger</span></code></a></li>
<li><a class="reference internal" href="#security.secure_bye_array.SecureByteArray.SECURE_WIPE_PASSES"><code class="docutils literal notranslate"><span class="pre">SecureByteArray.SECURE_WIPE_PASSES</span></code></a></li>
<li><a class="reference internal" href="#security.secure_bye_array.SecureByteArray.MIN_RANDOM_BYTES"><code class="docutils literal notranslate"><span class="pre">SecureByteArray.MIN_RANDOM_BYTES</span></code></a></li>
<li><a class="reference internal" href="#security.secure_bye_array.SecureByteArray.__init__"><code class="docutils literal notranslate"><span class="pre">SecureByteArray.__init__()</span></code></a></li>
<li><a class="reference internal" href="#security.secure_bye_array.SecureByteArray.secure_zero"><code class="docutils literal notranslate"><span class="pre">SecureByteArray.secure_zero()</span></code></a></li>
<li><a class="reference internal" href="#security.secure_bye_array.SecureByteArray.to_bytes"><code class="docutils literal notranslate"><span class="pre">SecureByteArray.to_bytes()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-utils.cryptocache">utils.cryptocache</a><ul>
<li><a class="reference internal" href="#utils.cryptocache.SecurityError"><code class="docutils literal notranslate"><span class="pre">SecurityError</span></code></a></li>
<li><a class="reference internal" href="#utils.cryptocache.initialize_environment"><code class="docutils literal notranslate"><span class="pre">initialize_environment()</span></code></a></li>
<li><a class="reference internal" href="#utils.cryptocache.CryptoCache"><code class="docutils literal notranslate"><span class="pre">CryptoCache</span></code></a><ul>
<li><a class="reference internal" href="#utils.cryptocache.CryptoCache.__init__"><code class="docutils literal notranslate"><span class="pre">CryptoCache.__init__()</span></code></a></li>
<li><a class="reference internal" href="#utils.cryptocache.CryptoCache.get_available_cryptocurrencies"><code class="docutils literal notranslate"><span class="pre">CryptoCache.get_available_cryptocurrencies()</span></code></a></li>
<li><a class="reference internal" href="#utils.cryptocache.CryptoCache.get_crypto_prices"><code class="docutils literal notranslate"><span class="pre">CryptoCache.get_crypto_prices()</span></code></a></li>
<li><a class="reference internal" href="#utils.cryptocache.CryptoCache.get_exchange_rate"><code class="docutils literal notranslate"><span class="pre">CryptoCache.get_exchange_rate()</span></code></a></li>
<li><a class="reference internal" href="#utils.cryptocache.CryptoCache.get"><code class="docutils literal notranslate"><span class="pre">CryptoCache.get()</span></code></a></li>
<li><a class="reference internal" href="#utils.cryptocache.CryptoCache.set"><code class="docutils literal notranslate"><span class="pre">CryptoCache.set()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-utils.portfolio_utils">utils.portfolio_utils</a><ul>
<li><a class="reference internal" href="#utils.portfolio_utils.Currency"><code class="docutils literal notranslate"><span class="pre">Currency</span></code></a><ul>
<li><a class="reference internal" href="#utils.portfolio_utils.Currency.USD"><code class="docutils literal notranslate"><span class="pre">Currency.USD</span></code></a></li>
<li><a class="reference internal" href="#utils.portfolio_utils.Currency.EUR"><code class="docutils literal notranslate"><span class="pre">Currency.EUR</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#utils.portfolio_utils.PortfolioCalculationError"><code class="docutils literal notranslate"><span class="pre">PortfolioCalculationError</span></code></a></li>
<li><a class="reference internal" href="#utils.portfolio_utils.InvalidInputError"><code class="docutils literal notranslate"><span class="pre">InvalidInputError</span></code></a></li>
<li><a class="reference internal" href="#utils.portfolio_utils.CurrencyError"><code class="docutils literal notranslate"><span class="pre">CurrencyError</span></code></a></li>
<li><a class="reference internal" href="#utils.portfolio_utils.validate_numeric_input"><code class="docutils literal notranslate"><span class="pre">validate_numeric_input()</span></code></a></li>
<li><a class="reference internal" href="#utils.portfolio_utils.validate_currency"><code class="docutils literal notranslate"><span class="pre">validate_currency()</span></code></a></li>
<li><a class="reference internal" href="#utils.portfolio_utils.calculate_portfolio_metrics"><code class="docutils literal notranslate"><span class="pre">calculate_portfolio_metrics()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-utils.token_jwt_handling">utils.token_jwt_handling</a><ul>
<li><a class="reference internal" href="#utils.token_jwt_handling.AuthError"><code class="docutils literal notranslate"><span class="pre">AuthError</span></code></a><ul>
<li><a class="reference internal" href="#utils.token_jwt_handling.AuthError.error"><code class="docutils literal notranslate"><span class="pre">AuthError.error</span></code></a></li>
<li><a class="reference internal" href="#utils.token_jwt_handling.AuthError.status_code"><code class="docutils literal notranslate"><span class="pre">AuthError.status_code</span></code></a></li>
<li><a class="reference internal" href="#utils.token_jwt_handling.AuthError.__init__"><code class="docutils literal notranslate"><span class="pre">AuthError.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#utils.token_jwt_handling.TokenJWTHandling"><code class="docutils literal notranslate"><span class="pre">TokenJWTHandling</span></code></a><ul>
<li><a class="reference internal" href="#utils.token_jwt_handling.TokenJWTHandling.__init__"><code class="docutils literal notranslate"><span class="pre">TokenJWTHandling.__init__()</span></code></a></li>
<li><a class="reference internal" href="#utils.token_jwt_handling.TokenJWTHandling.get_user_token_history"><code class="docutils literal notranslate"><span class="pre">TokenJWTHandling.get_user_token_history()</span></code></a></li>
<li><a class="reference internal" href="#utils.token_jwt_handling.TokenJWTHandling.check_token_request_eligibility"><code class="docutils literal notranslate"><span class="pre">TokenJWTHandling.check_token_request_eligibility()</span></code></a></li>
<li><a class="reference internal" href="#utils.token_jwt_handling.TokenJWTHandling.expire_previous_tokens"><code class="docutils literal notranslate"><span class="pre">TokenJWTHandling.expire_previous_tokens()</span></code></a></li>
<li><a class="reference internal" href="#utils.token_jwt_handling.TokenJWTHandling.get_active_token"><code class="docutils literal notranslate"><span class="pre">TokenJWTHandling.get_active_token()</span></code></a></li>
<li><a class="reference internal" href="#utils.token_jwt_handling.TokenJWTHandling.generate_tokens"><code class="docutils literal notranslate"><span class="pre">TokenJWTHandling.generate_tokens()</span></code></a></li>
<li><a class="reference internal" href="#utils.token_jwt_handling.TokenJWTHandling.get_token_creation_time"><code class="docutils literal notranslate"><span class="pre">TokenJWTHandling.get_token_creation_time()</span></code></a></li>
<li><a class="reference internal" href="#utils.token_jwt_handling.TokenJWTHandling.jwt_required"><code class="docutils literal notranslate"><span class="pre">TokenJWTHandling.jwt_required()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">CryptoFolio</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Welcome to Project Documentation of CryptoFolio</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="welcome-to-project-documentation-of-cryptofolio">
<h1>Welcome to Project Documentation of CryptoFolio<a class="headerlink" href="#welcome-to-project-documentation-of-cryptofolio" title="Link to this heading"></a></h1>
<section id="contents">
<h2>Contents<a class="headerlink" href="#contents" title="Link to this heading"></a></h2>
<div class="toctree-wrapper compound">
</div>
</section>
<section id="detailed-module-documentation">
<h2>Detailed Module Documentation<a class="headerlink" href="#detailed-module-documentation" title="Link to this heading"></a></h2>
</section>
</section>
<section id="app">
<h1>app<a class="headerlink" href="#app" title="Link to this heading"></a></h1>
</section>
<section id="module-configuration.config">
<span id="configuration-config"></span><h1>configuration.config<a class="headerlink" href="#module-configuration.config" title="Link to this heading"></a></h1>
<p>CryptoCache: Advanced Security Framework for Flask Applications
Version: 1.0
Author: Gabriel Cellammare
Last Modified: 05/01/2025</p>
<p>This module implements a comprehensive security framework for Flask applications with
defense-in-depth measures and robust security controls. It provides multi-layered
protection against various attack vectors while ensuring data integrity and secure
cross-origin communications.</p>
<p>Core Security Features:
1. Origin Validation</p>
<blockquote>
<div><ul class="simple">
<li><p>Strict origin validation with DNS rebinding protection</p></li>
<li><p>Null byte injection prevention</p></li>
<li><p>IP-based origin validation</p></li>
<li><p>Protocol enforcement</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Environment Security
* Secure environment variable handling
* Runtime modification prevention
* Default security fallbacks
* Configuration immutability</p></li>
<li><p>CORS Protection
* Header injection prevention
* Strict CORS policy enforcement
* Secure credential handling
* Cache poisoning protection</p></li>
<li><p>Audit &amp; Logging
* Secure audit logging
* Log sanitization
* Rotation policies
* Sensitive data masking</p></li>
</ol>
<p>Security Considerations:
- All environment variables must be securely configured
- SSL/TLS must be properly configured on the server
- Regular security audits should be performed
- Security updates should be monitored and applied</p>
<p>Dependencies:
- flask&gt;=2.0.0: Web framework
- urllib3&gt;=2.0.0: HTTP client
- cryptography&gt;=41.0.0: Cryptographic operations
- python-dotenv&gt;=1.0.0: Environment management</p>
<dl class="py exception">
<dt class="sig sig-object py" id="configuration.config.SecurityError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SecurityError</span></span><a class="reference internal" href="_modules/configuration/config.html#SecurityError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#configuration.config.SecurityError" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Base exception for security-related errors.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="configuration.config.ConfigurationError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ConfigurationError</span></span><a class="reference internal" href="_modules/configuration/config.html#ConfigurationError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#configuration.config.ConfigurationError" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#configuration.config.SecurityError" title="configuration.config.SecurityError"><code class="xref py py-class docutils literal notranslate"><span class="pre">SecurityError</span></code></a></p>
<p>Specific exception for configuration security issues.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="configuration.config.SecurityHeaders">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SecurityHeaders</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">HSTS</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'max-age=31536000;</span> <span class="pre">includeSubDomains'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CONTENT_TYPE_OPTIONS</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'nosniff'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FRAME_OPTIONS</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'DENY'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">XSS_PROTECTION</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'1;</span> <span class="pre">mode=block'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">REFERRER_POLICY</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'strict-origin-when-cross-origin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PERMITTED_CROSS_DOMAIN_POLICIES</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'none'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CSP</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">&quot;default-src</span> <span class="pre">'self';</span> <span class="pre">img-src</span> <span class="pre">'self'</span> <span class="pre">data:</span> <span class="pre">https:;</span> <span class="pre">style-src</span> <span class="pre">'self'</span> <span class="pre">'unsafe-inline'</span> <span class="pre">https://cdn.jsdelivr.net</span> <span class="pre">https://cdnjs.cloudflare.com;</span> <span class="pre">script-src</span> <span class="pre">'self'</span> <span class="pre">'unsafe-inline'</span> <span class="pre">'unsafe-eval'</span> <span class="pre">https://cdn.jsdelivr.net</span> <span class="pre">https://cdnjs.cloudflare.com</span> <span class="pre">https://code.jquery.com;</span> <span class="pre">font-src</span> <span class="pre">'self'</span> <span class="pre">https://cdnjs.cloudflare.com;</span> <span class="pre">connect-src</span> <span class="pre">'self'</span> <span class="pre">https://*.ngrok-free.app</span> <span class="pre">https://*.ngrok.io;</span> <span class="pre">frame-ancestors</span> <span class="pre">'none';&quot;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/configuration/config.html#SecurityHeaders"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#configuration.config.SecurityHeaders" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Immutable security headers configuration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="configuration.config.SecurityHeaders.HSTS">
<span class="sig-name descname"><span class="pre">HSTS</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'max-age=31536000;</span> <span class="pre">includeSubDomains'</span></em><a class="headerlink" href="#configuration.config.SecurityHeaders.HSTS" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="configuration.config.SecurityHeaders.CONTENT_TYPE_OPTIONS">
<span class="sig-name descname"><span class="pre">CONTENT_TYPE_OPTIONS</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'nosniff'</span></em><a class="headerlink" href="#configuration.config.SecurityHeaders.CONTENT_TYPE_OPTIONS" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="configuration.config.SecurityHeaders.FRAME_OPTIONS">
<span class="sig-name descname"><span class="pre">FRAME_OPTIONS</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'DENY'</span></em><a class="headerlink" href="#configuration.config.SecurityHeaders.FRAME_OPTIONS" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="configuration.config.SecurityHeaders.XSS_PROTECTION">
<span class="sig-name descname"><span class="pre">XSS_PROTECTION</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'1;</span> <span class="pre">mode=block'</span></em><a class="headerlink" href="#configuration.config.SecurityHeaders.XSS_PROTECTION" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="configuration.config.SecurityHeaders.REFERRER_POLICY">
<span class="sig-name descname"><span class="pre">REFERRER_POLICY</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'strict-origin-when-cross-origin'</span></em><a class="headerlink" href="#configuration.config.SecurityHeaders.REFERRER_POLICY" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="configuration.config.SecurityHeaders.PERMITTED_CROSS_DOMAIN_POLICIES">
<span class="sig-name descname"><span class="pre">PERMITTED_CROSS_DOMAIN_POLICIES</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'none'</span></em><a class="headerlink" href="#configuration.config.SecurityHeaders.PERMITTED_CROSS_DOMAIN_POLICIES" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="configuration.config.SecurityHeaders.CSP">
<span class="sig-name descname"><span class="pre">CSP</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&quot;default-src</span> <span class="pre">'self';</span> <span class="pre">img-src</span> <span class="pre">'self'</span> <span class="pre">data:</span> <span class="pre">https:;</span> <span class="pre">style-src</span> <span class="pre">'self'</span> <span class="pre">'unsafe-inline'</span> <span class="pre">https://cdn.jsdelivr.net</span> <span class="pre">https://cdnjs.cloudflare.com;</span> <span class="pre">script-src</span> <span class="pre">'self'</span> <span class="pre">'unsafe-inline'</span> <span class="pre">'unsafe-eval'</span> <span class="pre">https://cdn.jsdelivr.net</span> <span class="pre">https://cdnjs.cloudflare.com</span> <span class="pre">https://code.jquery.com;</span> <span class="pre">font-src</span> <span class="pre">'self'</span> <span class="pre">https://cdnjs.cloudflare.com;</span> <span class="pre">connect-src</span> <span class="pre">'self'</span> <span class="pre">https://*.ngrok-free.app</span> <span class="pre">https://*.ngrok.io;</span> <span class="pre">frame-ancestors</span> <span class="pre">'none';&quot;</span></em><a class="headerlink" href="#configuration.config.SecurityHeaders.CSP" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="configuration.config.SecurityHeaders.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">HSTS</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'max-age=31536000;</span> <span class="pre">includeSubDomains'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CONTENT_TYPE_OPTIONS</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'nosniff'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FRAME_OPTIONS</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'DENY'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">XSS_PROTECTION</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'1;</span> <span class="pre">mode=block'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">REFERRER_POLICY</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'strict-origin-when-cross-origin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PERMITTED_CROSS_DOMAIN_POLICIES</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'none'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CSP</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">&quot;default-src</span> <span class="pre">'self';</span> <span class="pre">img-src</span> <span class="pre">'self'</span> <span class="pre">data:</span> <span class="pre">https:;</span> <span class="pre">style-src</span> <span class="pre">'self'</span> <span class="pre">'unsafe-inline'</span> <span class="pre">https://cdn.jsdelivr.net</span> <span class="pre">https://cdnjs.cloudflare.com;</span> <span class="pre">script-src</span> <span class="pre">'self'</span> <span class="pre">'unsafe-inline'</span> <span class="pre">'unsafe-eval'</span> <span class="pre">https://cdn.jsdelivr.net</span> <span class="pre">https://cdnjs.cloudflare.com</span> <span class="pre">https://code.jquery.com;</span> <span class="pre">font-src</span> <span class="pre">'self'</span> <span class="pre">https://cdnjs.cloudflare.com;</span> <span class="pre">connect-src</span> <span class="pre">'self'</span> <span class="pre">https://*.ngrok-free.app</span> <span class="pre">https://*.ngrok.io;</span> <span class="pre">frame-ancestors</span> <span class="pre">'none';&quot;</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#configuration.config.SecurityHeaders.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="configuration.config.EnvironmentConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">EnvironmentConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">origins:</span> <span class="pre">~typing.List[str]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_requests:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">request_window:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">3600</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/configuration/config.html#EnvironmentConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#configuration.config.EnvironmentConfig" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Immutable environment-specific configuration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="configuration.config.EnvironmentConfig.origins">
<span class="sig-name descname"><span class="pre">origins</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#configuration.config.EnvironmentConfig.origins" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="configuration.config.EnvironmentConfig.max_requests">
<span class="sig-name descname"><span class="pre">max_requests</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">100</span></em><a class="headerlink" href="#configuration.config.EnvironmentConfig.max_requests" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="configuration.config.EnvironmentConfig.request_window">
<span class="sig-name descname"><span class="pre">request_window</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3600</span></em><a class="headerlink" href="#configuration.config.EnvironmentConfig.request_window" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="configuration.config.EnvironmentConfig.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">origins:</span> <span class="pre">~typing.List[str]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_requests:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">request_window:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">3600</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#configuration.config.EnvironmentConfig.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="configuration.config.SecureConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SecureConfig</span></span><a class="reference internal" href="_modules/configuration/config.html#SecureConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#configuration.config.SecureConfig" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Enhanced secure configuration manager for Flask applications.</p>
<p>This class manages secure configuration settings including CORS policies,
security headers, and environment-specific settings. It implements multiple
layers of security controls and validation.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="configuration.config.SecureConfig.DEFAULT_CORS_MAX_AGE">
<span class="sig-name descname"><span class="pre">DEFAULT_CORS_MAX_AGE</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3600</span></em><a class="headerlink" href="#configuration.config.SecureConfig.DEFAULT_CORS_MAX_AGE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="configuration.config.SecureConfig.DEFAULT_HSTS_MAX_AGE">
<span class="sig-name descname"><span class="pre">DEFAULT_HSTS_MAX_AGE</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">31536000</span></em><a class="headerlink" href="#configuration.config.SecureConfig.DEFAULT_HSTS_MAX_AGE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="configuration.config.SecureConfig.SUPPORTED_ENVIRONMENTS">
<span class="sig-name descname"><span class="pre">SUPPORTED_ENVIRONMENTS</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Set</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">frozenset({'development',</span> <span class="pre">'production'})</span></em><a class="headerlink" href="#configuration.config.SecureConfig.SUPPORTED_ENVIRONMENTS" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="configuration.config.SecureConfig.ORIGIN_PATTERN">
<span class="sig-name descname"><span class="pre">ORIGIN_PATTERN</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Pattern</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">re.compile('^https?://(?:(?:\\*\\.)?(?:[a-zA-Z0-9-]+\\.)*[a-zA-Z0-9-]+\\.[a-zA-Z]{2,}(?::\\d{1,5})?|localhost(?::\\d{1,5})?|127\\.0\\.0\\.1(?::\\d{1,5})?|\\[::1\\](?::\\d{1,5})?)$')</span></em><a class="headerlink" href="#configuration.config.SecureConfig.ORIGIN_PATTERN" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="configuration.config.SecureConfig.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/configuration/config.html#SecureConfig.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#configuration.config.SecureConfig.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize secure configuration with audit logging and encryption.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="configuration.config.SecureConfig.initialize_app">
<span class="sig-name descname"><span class="pre">initialize_app</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Flask</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/configuration/config.html#SecureConfig.initialize_app"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#configuration.config.SecureConfig.initialize_app" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="configuration.config.SecureConfig.get_allowed_origins">
<span class="sig-name descname"><span class="pre">get_allowed_origins</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/configuration/config.html#SecureConfig.get_allowed_origins"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#configuration.config.SecureConfig.get_allowed_origins" title="Link to this definition"></a></dt>
<dd><p>Get cached list of allowed origins for current environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of allowed origins</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="configuration.config.SecureConfig.add_security_headers">
<span class="sig-name descname"><span class="pre">add_security_headers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">response</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Response</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Response</span></span></span><a class="reference internal" href="_modules/configuration/config.html#SecureConfig.add_security_headers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#configuration.config.SecureConfig.add_security_headers" title="Link to this definition"></a></dt>
<dd><p>Add comprehensive security headers to response.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-configuration.init_app">
<span id="configuration-init-app"></span><h1>configuration.init_app<a class="headerlink" href="#module-configuration.init_app" title="Link to this heading"></a></h1>
<p>Enhanced Flask Application Initializer
Version: 1.0
Author: Gabriel Cellammare
Last Modified: 05/01/2025</p>
<p>This module implements a secure Flask application initialization system with
strong focus on configuration security, authentication protection, and
secure environment management.</p>
<p>Security Features:
1. Environment Protection</p>
<blockquote>
<div><ul class="simple">
<li><p>Secure secret key management</p></li>
<li><p>Protected environment variables</p></li>
<li><p>Encryption key validation</p></li>
<li><p>Configuration isolation</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Authentication Security
- OAuth provider protection
- Secure callback handling
- Protected client credentials
- Token management safety</p></li>
<li><p>Server Security
- CORS protection
- Firebase security
- Development tunnel safety
- Session management</p></li>
<li><p>Configuration Management
- Protected variable handling
- Secure initialization
- Error isolation
- Safe defaults</p></li>
</ol>
<p>Security Considerations:
- All sensitive configuration is validated
- OAuth credentials are protected
- Environment variables are verified
- Development modes are isolated
- Error states provide safe defaults
- CORS is strictly configured
- Firebase credentials are protected
- Tunneling is secured in development</p>
<p>Dependencies:
- flask: Web application framework
- authlib: OAuth implementation
- firebase_admin: Firebase operations
- python-dotenv: Environment management
- os</p>
<dl class="py function">
<dt class="sig sig-object py" id="configuration.init_app.validate_environment_variables">
<span class="sig-name descname"><span class="pre">validate_environment_variables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">required_vars</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/configuration/init_app.html#validate_environment_variables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#configuration.init_app.validate_environment_variables" title="Link to this definition"></a></dt>
<dd><p>Securely validate presence and format of required environment variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>required_vars</strong> – List of required environment variable names</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any required variable is missing or invalid</p>
</dd>
</dl>
<p>Security measures:
- Presence verification
- Format validation
- Error isolation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="configuration.init_app.validate_secret_key">
<span class="sig-name descname"><span class="pre">validate_secret_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/configuration/init_app.html#validate_secret_key"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#configuration.init_app.validate_secret_key" title="Link to this definition"></a></dt>
<dd><p>Validate the security of the Flask secret key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> – Secret key to validate</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If key doesn’t meet security requirements</p>
</dd>
</dl>
<p>Security measures:
- Length verification
- Entropy checking
- Format validation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="configuration.init_app.secure_firebase_init">
<span class="sig-name descname"><span class="pre">secure_firebase_init</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/configuration/init_app.html#secure_firebase_init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#configuration.init_app.secure_firebase_init" title="Link to this definition"></a></dt>
<dd><p>Securely initialize Firebase with proper credential handling.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>FileNotFoundError</strong> – If credential file is missing</p></li>
<li><p><strong>ValueError</strong> – If credentials are invalid</p></li>
</ul>
</dd>
</dl>
<p>Security measures:
- Path validation
- Credential verification
- Error isolation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="configuration.init_app.create_app">
<span class="sig-name descname"><span class="pre">create_app</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">secure_config</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Flask</span></span></span><a class="reference internal" href="_modules/configuration/init_app.html#create_app"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#configuration.init_app.create_app" title="Link to this definition"></a></dt>
<dd><p>Creates and configures a secure Flask application instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Configured Flask application</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Flask</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ValueError</strong> – On security configuration failures</p></li>
<li><p><a class="reference internal" href="#configuration.config.ConfigurationError" title="configuration.config.ConfigurationError"><strong>ConfigurationError</strong></a> – On CORS configuration failures</p></li>
</ul>
</dd>
</dl>
<p>Security measures:
- Secure initialization
- Protected configuration
- Error isolation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="configuration.init_app.configure_development_environment">
<span class="sig-name descname"><span class="pre">configure_development_environment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Flask</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/configuration/init_app.html#configure_development_environment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#configuration.init_app.configure_development_environment" title="Link to this definition"></a></dt>
<dd><p>Configure secure development environment settings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>app</strong> – Flask application instance</p>
</dd>
</dl>
<p>Security measures:
- Tunnel protection
- URL validation
- Error isolation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="configuration.init_app.configure_oauth">
<span class="sig-name descname"><span class="pre">configure_oauth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Flask</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">OAuth</span></span></span><a class="reference internal" href="_modules/configuration/init_app.html#configure_oauth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#configuration.init_app.configure_oauth" title="Link to this definition"></a></dt>
<dd><p>Configure secure OAuth providers for authentication.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>app</strong> – Flask application instance</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Configured OAuth instance</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OAuth</p>
</dd>
</dl>
<p>Security measures:
- Credential validation
- URL verification
- Scope restriction</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="configuration.init_app.determine_callback_base_url">
<span class="sig-name descname"><span class="pre">determine_callback_base_url</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/configuration/init_app.html#determine_callback_base_url"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#configuration.init_app.determine_callback_base_url" title="Link to this definition"></a></dt>
<dd><p>Securely determine the base URL for OAuth callbacks.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Validated base URL</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
<p>Security measures:
- URL validation
- Protocol verification
- Environment isolation</p>
</dd></dl>

</section>
<section id="module-configuration.ngrok_manager">
<span id="configuration-ngrok-manager"></span><h1>configuration.ngrok_manager<a class="headerlink" href="#module-configuration.ngrok_manager" title="Link to this heading"></a></h1>
<p>Enhanced Ngrok Tunnel Manager
Version: 1.0
Author: Gabriel Cellammare
Last Modified: 05/01/2025</p>
<p>This module implements secure ngrok tunnel management with a strong focus on
memory safety, secure state persistence, and protected network operations.</p>
<p>Security Features:
1. Connection Protection</p>
<blockquote>
<div><ul class="simple">
<li><p>Secure tunnel establishment</p></li>
<li><p>Protected URL management</p></li>
<li><p>SSL/TLS verification</p></li>
<li><p>Timeout protection</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>State Management Security
- Secure file operations
- Protected state persistence
- Memory-safe operations
- Automatic cleanup</p></li>
<li><p>Configuration Security
- Protected environment variables
- Secure token handling
- Region validation
- Safe defaults</p></li>
<li><p>Error Management
- Secure error recovery
- Non-revealing messages
- Protected logging
- Failsafe defaults</p></li>
</ol>
<p>Security Considerations:
- All sensitive data is automatically cleaned up
- Network operations are protected
- Logging excludes sensitive information
- File operations are secure
- Error states provide safe defaults</p>
<p>Dependencies:
- pyngrok: For ngrok tunnel operations
- requests: For secure HTTP operations
- flask: For application integration
- pathlib: For secure file operations</p>
<dl class="py class">
<dt class="sig sig-object py" id="configuration.ngrok_manager.NgrokManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">NgrokManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/configuration/ngrok_manager.html#NgrokManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#configuration.ngrok_manager.NgrokManager" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Manages ngrok tunnel configuration and persistence with security focus.
Implements secure tunnel creation, URL management, and state persistence.</p>
<p>Security Features:
- Protected tunnel operations
- Secure state management
- Memory-safe cleanup
- Protected logging</p>
<dl class="py method">
<dt class="sig sig-object py" id="configuration.ngrok_manager.NgrokManager.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/configuration/ngrok_manager.html#NgrokManager.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#configuration.ngrok_manager.NgrokManager.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize NgrokManager with security considerations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>app</strong> – Optional Flask application instance</p>
</dd>
</dl>
<p>Security measures:
- Secure logger initialization
- Protected file operations
- Safe defaults</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="configuration.ngrok_manager.NgrokManager.init_app">
<span class="sig-name descname"><span class="pre">init_app</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/configuration/ngrok_manager.html#NgrokManager.init_app"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#configuration.ngrok_manager.NgrokManager.init_app" title="Link to this definition"></a></dt>
<dd><p>Initialize with Flask app instance securely.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>app</strong> – Flask application instance</p>
</dd>
</dl>
<p>Security measures:
- Token validation
- Region verification
- Protected configuration</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="configuration.ngrok_manager.NgrokManager.start_tunnel">
<span class="sig-name descname"><span class="pre">start_tunnel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">port</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/configuration/ngrok_manager.html#NgrokManager.start_tunnel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#configuration.ngrok_manager.NgrokManager.start_tunnel" title="Link to this definition"></a></dt>
<dd><p>Start ngrok tunnel securely for the specified port.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>port</strong> – Local port to tunnel</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Public ngrok URL</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
<p>Security measures:
- Port validation
- Secure health check
- Protected tunnel creation
- Error handling</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-doc_generator">
<span id="doc-generator"></span><h1>doc_generator<a class="headerlink" href="#module-doc_generator" title="Link to this heading"></a></h1>
<p>Documentation Generator Security Framework
Version: 1.0
Author: Gabriel Cellammare
Last Modified: 05/01/2025</p>
<p>This module implements a secure and robust documentation generation system with
a strong focus on module discovery protection, configuration security, and
safe file system operations.</p>
<p>Security Features:
1. File System Protection</p>
<blockquote>
<div><ul class="simple">
<li><p>Secure path traversal prevention</p></li>
<li><p>Protected file operations</p></li>
<li><p>Safe directory creation</p></li>
<li><p>Path validation and sanitization</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Module Security
- Protected module discovery
- Secure import handling
- Module isolation
- Safe module resolution</p></li>
<li><p>Documentation Security
- Protected configuration generation
- Secure theme handling
- Safe template management
- Output isolation</p></li>
<li><p>Configuration Management
- Protected variable handling
- Secure initialization
- Error isolation
- Safe defaults</p></li>
</ol>
<p>Security Considerations:
- All file paths are validated and sanitized
- Module imports are protected
- Configuration files are isolated
- Development artifacts are protected
- Error states provide safe defaults
- Directory traversal is prevented
- Module resolution is secured
- Output paths are protected</p>
<p>Dependencies:
- sphinx: Documentation generation framework
- pdoc: Alternative documentation generator
- pathlib: Secure path operations
- importlib: Protected module importing</p>
<dl class="py class">
<dt class="sig sig-object py" id="doc_generator.DocGenerator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DocGenerator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">project_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/doc_generator.html#DocGenerator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#doc_generator.DocGenerator" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class that automates documentation generation from Python source files.</p>
<p>This class provides functionality to:
1. Discover Python modules in a project directory
2. Generate documentation using either Sphinx or pdoc
3. Handle configuration and setup for documentation generation
4. Provide error handling and fallback options</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="doc_generator.DocGenerator.project_dir">
<span class="sig-name descname"><span class="pre">project_dir</span></span><a class="headerlink" href="#doc_generator.DocGenerator.project_dir" title="Link to this definition"></a></dt>
<dd><p>Root directory containing Python source files</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="doc_generator.DocGenerator.output_dir">
<span class="sig-name descname"><span class="pre">output_dir</span></span><a class="headerlink" href="#doc_generator.DocGenerator.output_dir" title="Link to this definition"></a></dt>
<dd><p>Directory where documentation will be generated</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="doc_generator.DocGenerator.has_rtd_theme">
<span class="sig-name descname"><span class="pre">has_rtd_theme</span></span><a class="headerlink" href="#doc_generator.DocGenerator.has_rtd_theme" title="Link to this definition"></a></dt>
<dd><p>Flag indicating if sphinx_rtd_theme is available</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="doc_generator.DocGenerator.python_files">
<span class="sig-name descname"><span class="pre">python_files</span></span><a class="headerlink" href="#doc_generator.DocGenerator.python_files" title="Link to this definition"></a></dt>
<dd><p>Mapping of module names to file paths</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Path]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="doc_generator.DocGenerator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">project_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/doc_generator.html#DocGenerator.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#doc_generator.DocGenerator.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize the documentation generator with project and output directories.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>project_dir</strong> – Root directory containing Python source files</p></li>
<li><p><strong>output_dir</strong> – Directory where documentation will be generated</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If no Python files are found in the project directory</p></li>
<li><p><strong>TypeError</strong> – If input parameters are not str or Path objects</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="doc_generator.DocGenerator.setup_sphinx">
<span class="sig-name descname"><span class="pre">setup_sphinx</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/doc_generator.html#DocGenerator.setup_sphinx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#doc_generator.DocGenerator.setup_sphinx" title="Link to this definition"></a></dt>
<dd><p>Set up Sphinx configuration and create necessary directory structure.</p>
<p>This method:
1. Creates required Sphinx directories
2. Generates conf.py with project configuration
3. Creates index.rst with module documentation structure
4. Configures theme and extensions</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>IOError</strong> – If unable to create necessary files or directories</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="doc_generator.DocGenerator.generate_sphinx_docs">
<span class="sig-name descname"><span class="pre">generate_sphinx_docs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/doc_generator.html#DocGenerator.generate_sphinx_docs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#doc_generator.DocGenerator.generate_sphinx_docs" title="Link to this definition"></a></dt>
<dd><p>Generate Sphinx documentation for all discovered Python files.</p>
<p>This method:
1. Sets up Sphinx configuration
2. Builds HTML documentation
3. Handles errors and provides theme fallback</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – If documentation generation fails after fallback attempts</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="doc_generator.DocGenerator.generate_pdoc_docs">
<span class="sig-name descname"><span class="pre">generate_pdoc_docs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/doc_generator.html#DocGenerator.generate_pdoc_docs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#doc_generator.DocGenerator.generate_pdoc_docs" title="Link to this definition"></a></dt>
<dd><p>Generate pdoc documentation for all discovered Python files.</p>
<p>This method:
1. Adds project directory to Python path
2. Generates HTML documentation using pdoc
3. Outputs documentation to specified directory</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – If pdoc documentation generation fails</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="doc_generator.DocGenerator.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">doc_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'sphinx'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/doc_generator.html#DocGenerator.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#doc_generator.DocGenerator.run" title="Link to this definition"></a></dt>
<dd><p>Execute the documentation generation process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>doc_type</strong> – Type of documentation to generate (‘sphinx’ or ‘pdoc’)</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – Unsupported documentation type</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="doc_generator.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/doc_generator.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#doc_generator.main" title="Link to this definition"></a></dt>
<dd><p>Command-line interface for the documentation generator.</p>
</dd></dl>

</section>
<section id="module-security.cryptography.cryptography_utils">
<span id="security-cryptography-cryptography-utils"></span><h1>security.cryptography.cryptography_utils<a class="headerlink" href="#module-security.cryptography.cryptography_utils" title="Link to this heading"></a></h1>
<p>Secure Cryptographic Operations Framework
Version: 1.0
Author: Gabriel Cellammare
Last Modified: 05/01/2025
This module implements a comprehensive cryptographic system with a strong focus on
secure memory management, user identity protection, and robust encryption operations.
It provides a defense-in-depth approach to protecting sensitive data through multiple
layers of security controls and careful memory handling.
Core Security Features:</p>
<p>Memory Protection</p>
<p>Secure byte array implementation for sensitive data
Automatic memory zeroing after operations
Protected key material handling
Managed cleanup of cryptographic artifacts</p>
<p>Encryption Operations</p>
<p>AES-256-CBC encryption with PKCS7 padding
Secure initialization vector management
Salt generation and validation
Protected cipher operations</p>
<p>Key Management</p>
<p>Secure key derivation using PBKDF2-HMAC-SHA3-256
User-specific key isolation
Master key protection
Salt management for key derivation</p>
<p>Identity Protection</p>
<p>Secure user ID hashing with HMAC-SHA256
Protected hash verification
Timing attack prevention
Base64 URL-safe encoding</p>
<p>Security Considerations:</p>
<p>All cryptographic operations use constant-time comparisons
Memory containing sensitive data is securely erased
Side-channel attack protections are implemented
Cryptographic error states are safely handled
Key material is protected throughout its lifecycle
User identities are consistently hashed
Encryption operations are isolated per user</p>
<p>Dependencies:</p>
<p>-cryptography: Core cryptographic operations
-secure_byte_array: Protected memory management
-hashlib: Hashing operations
-base64: Secure encoding
-typing: Type safety
-logging: Security event tracking</p>
<dl class="py exception">
<dt class="sig sig-object py" id="security.cryptography.cryptography_utils.CryptographicError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CryptographicError</span></span><a class="reference internal" href="_modules/security/cryptography/cryptography_utils.html#CryptographicError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.cryptography.cryptography_utils.CryptographicError" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Custom exception for cryptographic errors.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="security.cryptography.cryptography_utils.AESCipher">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AESCipher</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">master_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#security.secure_bye_array.SecureByteArray" title="security.secure_bye_array.SecureByteArray"><span class="pre">SecureByteArray</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/security/cryptography/cryptography_utils.html#AESCipher"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.cryptography.cryptography_utils.AESCipher" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Secure implementation of AES encryption with protected memory management and user ID hashing.</p>
<p>This class provides:
- AES-256-CBC encryption with secure key derivation
- Secure memory management using SecureByteArray
- Protection against timing and side-channel attacks
- Automatic PKCS7 padding management
- Secure user ID hashing with HMAC-SHA256 and base64 encoding</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="security.cryptography.cryptography_utils.AESCipher.BLOCK_SIZE">
<span class="sig-name descname"><span class="pre">BLOCK_SIZE</span></span><a class="headerlink" href="#security.cryptography.cryptography_utils.AESCipher.BLOCK_SIZE" title="Link to this definition"></a></dt>
<dd><p>AES block size in bytes</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="security.cryptography.cryptography_utils.AESCipher.KEY_LENGTH">
<span class="sig-name descname"><span class="pre">KEY_LENGTH</span></span><a class="headerlink" href="#security.cryptography.cryptography_utils.AESCipher.KEY_LENGTH" title="Link to this definition"></a></dt>
<dd><p>Key length in bytes</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="security.cryptography.cryptography_utils.AESCipher.IV_LENGTH">
<span class="sig-name descname"><span class="pre">IV_LENGTH</span></span><a class="headerlink" href="#security.cryptography.cryptography_utils.AESCipher.IV_LENGTH" title="Link to this definition"></a></dt>
<dd><p>Initialization vector length</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="security.cryptography.cryptography_utils.AESCipher.SALT_LENGTH">
<span class="sig-name descname"><span class="pre">SALT_LENGTH</span></span><a class="headerlink" href="#security.cryptography.cryptography_utils.AESCipher.SALT_LENGTH" title="Link to this definition"></a></dt>
<dd><p>Salt length for key derivation</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="security.cryptography.cryptography_utils.AESCipher.KDF_ITERATIONS">
<span class="sig-name descname"><span class="pre">KDF_ITERATIONS</span></span><a class="headerlink" href="#security.cryptography.cryptography_utils.AESCipher.KDF_ITERATIONS" title="Link to this definition"></a></dt>
<dd><p>Number of iterations for key derivation</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">BLOCK_SIZE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">32</span></em><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">KEY_LENGTH</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">32</span></em><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">IV_LENGTH</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">16</span></em><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">SALT_LENGTH</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">32</span></em><a class="headerlink" href="#id3" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">KDF_ITERATIONS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">300000</span></em><a class="headerlink" href="#id4" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="security.cryptography.cryptography_utils.AESCipher.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">master_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#security.secure_bye_array.SecureByteArray" title="security.secure_bye_array.SecureByteArray"><span class="pre">SecureByteArray</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/security/cryptography/cryptography_utils.html#AESCipher.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.cryptography.cryptography_utils.AESCipher.__init__" title="Link to this definition"></a></dt>
<dd><p>Initializes the AES cipher with a master key and optional app secret for user ID hashing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>master_key</strong> – Master key as string, bytes, or SecureByteArray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#security.cryptography.cryptography_utils.CryptographicError" title="security.cryptography.cryptography_utils.CryptographicError"><strong>CryptographicError</strong></a> – If the master key is invalid</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="security.cryptography.cryptography_utils.AESCipher.hash_user_id">
<span class="sig-name descname"><span class="pre">hash_user_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">provider</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">original_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/security/cryptography/cryptography_utils.html#AESCipher.hash_user_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.cryptography.cryptography_utils.AESCipher.hash_user_id" title="Link to this definition"></a></dt>
<dd><p>Generates a secure and consistent hash of the user ID using HMAC-SHA256,
encoded in URL-safe base64 format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>provider</strong> – OAuth provider identifier (e.g., ‘google’, ‘github’)</p></li>
<li><p><strong>original_id</strong> – Original user ID from the provider</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Base64 encoded hash, URL-safe without padding</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If provider or original_id is empty</p></li>
<li><p><a class="reference internal" href="#security.cryptography.cryptography_utils.CryptographicError" title="security.cryptography.cryptography_utils.CryptographicError"><strong>CryptographicError</strong></a> – If hashing fails</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="security.cryptography.cryptography_utils.AESCipher.verify_user_id_hash">
<span class="sig-name descname"><span class="pre">verify_user_id_hash</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">provider</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">original_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashed_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/security/cryptography/cryptography_utils.html#AESCipher.verify_user_id_hash"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.cryptography.cryptography_utils.AESCipher.verify_user_id_hash" title="Link to this definition"></a></dt>
<dd><p>Verifies if a base64 encoded hash matches a given user ID using constant-time comparison.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>provider</strong> – OAuth provider identifier</p></li>
<li><p><strong>original_id</strong> – Original user ID</p></li>
<li><p><strong>hashed_id</strong> – Base64 encoded hash to verify</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the hash matches, False otherwise</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#security.cryptography.cryptography_utils.CryptographicError" title="security.cryptography.cryptography_utils.CryptographicError"><strong>CryptographicError</strong></a> – If verification fails</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="security.cryptography.cryptography_utils.AESCipher.generate_salt">
<span class="sig-name descname"><span class="pre">generate_salt</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#security.secure_bye_array.SecureByteArray" title="security.secure_bye_array.SecureByteArray"><span class="pre">SecureByteArray</span></a></span></span><a class="reference internal" href="_modules/security/cryptography/cryptography_utils.html#AESCipher.generate_salt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.cryptography.cryptography_utils.AESCipher.generate_salt" title="Link to this definition"></a></dt>
<dd><p>Generates a cryptographically secure salt.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Generated salt</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#security.secure_bye_array.SecureByteArray" title="security.secure_bye_array.SecureByteArray">SecureByteArray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="security.cryptography.cryptography_utils.AESCipher.derive_key">
<span class="sig-name descname"><span class="pre">derive_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">salt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#security.secure_bye_array.SecureByteArray" title="security.secure_bye_array.SecureByteArray"><span class="pre">SecureByteArray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#security.secure_bye_array.SecureByteArray" title="security.secure_bye_array.SecureByteArray"><span class="pre">SecureByteArray</span></a></span></span><a class="reference internal" href="_modules/security/cryptography/cryptography_utils.html#AESCipher.derive_key"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.cryptography.cryptography_utils.AESCipher.derive_key" title="Link to this definition"></a></dt>
<dd><p>Derives a user-specific key using PBKDF2-HMAC-SHA3-256.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>user_id</strong> – User identifier</p></li>
<li><p><strong>salt</strong> – Salt for key derivation</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Derived key</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#security.secure_bye_array.SecureByteArray" title="security.secure_bye_array.SecureByteArray">SecureByteArray</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#security.cryptography.cryptography_utils.CryptographicError" title="security.cryptography.cryptography_utils.CryptographicError"><strong>CryptographicError</strong></a> – If key derivation fails</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="security.cryptography.cryptography_utils.AESCipher.encrypt">
<span class="sig-name descname"><span class="pre">encrypt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">salt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#security.secure_bye_array.SecureByteArray" title="security.secure_bye_array.SecureByteArray"><span class="pre">SecureByteArray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bytes</span></span></span><a class="reference internal" href="_modules/security/cryptography/cryptography_utils.html#AESCipher.encrypt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.cryptography.cryptography_utils.AESCipher.encrypt" title="Link to this definition"></a></dt>
<dd><p>Encrypts data using AES-256-CBC with secure memory management.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Data to encrypt (can be any JSON serializable type)</p></li>
<li><p><strong>user_id</strong> – User identifier</p></li>
<li><p><strong>salt</strong> – Salt for key derivation</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Encrypted data encoded in base64</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bytes</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#security.cryptography.cryptography_utils.CryptographicError" title="security.cryptography.cryptography_utils.CryptographicError"><strong>CryptographicError</strong></a> – If encryption fails</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="security.cryptography.cryptography_utils.AESCipher.decrypt">
<span class="sig-name descname"><span class="pre">decrypt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">encrypted_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#security.secure_bye_array.SecureByteArray" title="security.secure_bye_array.SecureByteArray"><span class="pre">SecureByteArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">salt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#security.secure_bye_array.SecureByteArray" title="security.secure_bye_array.SecureByteArray"><span class="pre">SecureByteArray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="_modules/security/cryptography/cryptography_utils.html#AESCipher.decrypt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.cryptography.cryptography_utils.AESCipher.decrypt" title="Link to this definition"></a></dt>
<dd><p>Decrypts data with secure memory management.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>encrypted_data</strong> – Encrypted data (can be string, bytes, or SecureByteArray)</p></li>
<li><p><strong>user_id</strong> – User identifier</p></li>
<li><p><strong>salt</strong> – Salt used for encryption</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Decrypted data (JSON object or string)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-security.cryptography.portfolio_encryption">
<span id="security-cryptography-portfolio-encryption"></span><h1>security.cryptography.portfolio_encryption<a class="headerlink" href="#module-security.cryptography.portfolio_encryption" title="Link to this heading"></a></h1>
<p>Enhanced Portfolio Metrics Calculator
Version: 1.0
Author: [Gabriel Cellammare]
Last Modified: [05/01/2025]</p>
<p>This module implements secure portfolio data encryption and decryption with a strong
focus on memory safety, cryptographic best practices, and secure data handling.</p>
<p>Security Features:
1. Memory Protection</p>
<blockquote>
<div><ul class="simple">
<li><p>Secure memory allocation and deallocation</p></li>
<li><p>Multiple-pass memory wiping</p></li>
<li><p>Protected memory regions for sensitive data</p></li>
<li><p>Automatic cleanup of sensitive information</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Cryptographic Security
- AES encryption for sensitive data
- Secure key and salt handling
- Isolation of cryptographic operations
- Protection against timing attacks</p></li>
<li><p>Error Handling
- Secure error recovery
- Non-revealing error messages
- Protected logging of sensitive data
- Failsafe defaults for errors</p></li>
<li><p>Input/Output Safety
- Strict type validation
- Secure conversion operations
- Protected field handling
- Safe defaults for failures</p></li>
</ol>
<p>Security Considerations:
- All sensitive data is automatically wiped from memory
- Cryptographic operations are isolated
- Logging excludes sensitive information
- Memory is protected against unauthorized access
- Type conversions are handled securely
- Error states provide safe defaults</p>
<p>Dependencies:
- cryptography_utils.AESCipher: For encryption operations
- secure_byte_array.SecureByteArray: For secure memory operations</p>
<dl class="py exception">
<dt class="sig sig-object py" id="security.cryptography.portfolio_encryption.PortfolioEncryptionError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PortfolioEncryptionError</span></span><a class="reference internal" href="_modules/security/cryptography/portfolio_encryption.html#PortfolioEncryptionError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.cryptography.portfolio_encryption.PortfolioEncryptionError" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Custom exception for portfolio encryption errors.</p>
<p>Security:
- Does not expose internal state
- Provides generic error messages
- Protects against information leakage</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="security.cryptography.portfolio_encryption.PortfolioEncryption">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PortfolioEncryption</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cipher</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#security.cryptography.cryptography_utils.AESCipher" title="security.cryptography.cryptography_utils.AESCipher"><span class="pre">AESCipher</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/security/cryptography/portfolio_encryption.html#PortfolioEncryption"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.cryptography.portfolio_encryption.PortfolioEncryption" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Secure portfolio data encryption implementation.</p>
<p>Security Architecture:
1. Memory Safety</p>
<blockquote>
<div><ul class="simple">
<li><p>Automatic memory cleanup</p></li>
<li><p>Protected memory regions</p></li>
<li><p>Secure memory wiping</p></li>
<li><p>Isolation of sensitive data</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Cryptographic Operations
- Secure key management
- Protected encryption/decryption
- Salt handling
- Timing attack protection</p></li>
<li><p>Data Protection
- Secure type conversion
- Protected field handling
- Safe default values
- Error state handling</p></li>
<li><p>Access Control
- Initialization verification
- Operation isolation
- Memory access control
- Cleanup guarantees</p></li>
</ol>
<p>Usage Warnings:
1. Memory Management</p>
<blockquote>
<div><ul class="simple">
<li><p>Always use with context managers</p></li>
<li><p>Verify cleanup completion</p></li>
<li><p>Monitor memory usage</p></li>
<li><p>Check cleanup logs</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Error Handling
- Implement proper exception catching
- Verify error states
- Check return values
- Monitor error logs</p></li>
<li><p>Cryptographic Safety
- Protect key material
- Verify salt uniqueness
- Monitor operation logs
- Check integrity</p></li>
</ol>
<dl class="py attribute">
<dt class="sig sig-object py" id="security.cryptography.portfolio_encryption.PortfolioEncryption.SENSITIVE_FIELDS">
<span class="sig-name descname"><span class="pre">SENSITIVE_FIELDS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">frozenset({'amount',</span> <span class="pre">'purchase_date',</span> <span class="pre">'purchase_price'})</span></em><a class="headerlink" href="#security.cryptography.portfolio_encryption.PortfolioEncryption.SENSITIVE_FIELDS" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="security.cryptography.portfolio_encryption.PortfolioEncryption.SECURE_MEMORY_WIPE_PASSES">
<span class="sig-name descname"><span class="pre">SECURE_MEMORY_WIPE_PASSES</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#security.cryptography.portfolio_encryption.PortfolioEncryption.SECURE_MEMORY_WIPE_PASSES" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="security.cryptography.portfolio_encryption.PortfolioEncryption.DEFAULT_NUMERIC_VALUE">
<span class="sig-name descname"><span class="pre">DEFAULT_NUMERIC_VALUE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">Decimal('0.0')</span></em><a class="headerlink" href="#security.cryptography.portfolio_encryption.PortfolioEncryption.DEFAULT_NUMERIC_VALUE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="security.cryptography.portfolio_encryption.PortfolioEncryption.DEFAULT_STRING_VALUE">
<span class="sig-name descname"><span class="pre">DEFAULT_STRING_VALUE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">''</span></em><a class="headerlink" href="#security.cryptography.portfolio_encryption.PortfolioEncryption.DEFAULT_STRING_VALUE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="security.cryptography.portfolio_encryption.PortfolioEncryption.logger">
<span class="sig-name descname"><span class="pre">logger</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">security.cryptography.portfolio_encryption</span> <span class="pre">(INFO)&gt;</span></em><a class="headerlink" href="#security.cryptography.portfolio_encryption.PortfolioEncryption.logger" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="security.cryptography.portfolio_encryption.PortfolioEncryption.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cipher</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#security.cryptography.cryptography_utils.AESCipher" title="security.cryptography.cryptography_utils.AESCipher"><span class="pre">AESCipher</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/security/cryptography/portfolio_encryption.html#PortfolioEncryption.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.cryptography.portfolio_encryption.PortfolioEncryption.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize encryption system with security verification.</p>
<p>Security Operations:
1. Cipher validation</p>
<blockquote>
<div><ul class="simple">
<li><p>Verify interface compliance</p></li>
<li><p>Check method availability</p></li>
<li><p>Validate initialization</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Memory preparation
- Initialize secure buffers
- Prepare cleanup tracking
- Set up protection</p></li>
<li><p>State verification
- Check initialization status
- Verify configurations
- Validate security settings</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cipher</strong> – AESCipher instance for cryptographic operations</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#security.cryptography.portfolio_encryption.PortfolioEncryptionError" title="security.cryptography.portfolio_encryption.PortfolioEncryptionError"><strong>PortfolioEncryptionError</strong></a> – On security verification failure</p>
</dd>
</dl>
<p>Security Checks:
- Cipher interface verification
- Memory initialization
- Protection setup
- State validation</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="security.cryptography.portfolio_encryption.PortfolioEncryption.encrypt_portfolio_item">
<span class="sig-name descname"><span class="pre">encrypt_portfolio_item</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">salt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#security.secure_bye_array.SecureByteArray" title="security.secure_bye_array.SecureByteArray"><span class="pre">SecureByteArray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="_modules/security/cryptography/portfolio_encryption.html#PortfolioEncryption.encrypt_portfolio_item"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.cryptography.portfolio_encryption.PortfolioEncryption.encrypt_portfolio_item" title="Link to this definition"></a></dt>
<dd><p>Securely encrypts portfolio item data with memory protection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>item</strong> – Portfolio data to encrypt</p></li>
<li><p><strong>user_id</strong> – User identifier</p></li>
<li><p><strong>salt</strong> – Cryptographic salt</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Encrypted portfolio data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#security.cryptography.portfolio_encryption.PortfolioEncryptionError" title="security.cryptography.portfolio_encryption.PortfolioEncryptionError"><strong>PortfolioEncryptionError</strong></a> – If encryption fails</p>
</dd>
</dl>
<dl class="simple">
<dt>Security:</dt><dd><ul class="simple">
<li><p>Validates input parameters</p></li>
<li><p>Implements secure memory handling</p></li>
<li><p>Automatic cleanup of sensitive data</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="security.cryptography.portfolio_encryption.PortfolioEncryption.decrypt_portfolio_item">
<span class="sig-name descname"><span class="pre">decrypt_portfolio_item</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">encrypted_item</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">salt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#security.secure_bye_array.SecureByteArray" title="security.secure_bye_array.SecureByteArray"><span class="pre">SecureByteArray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="_modules/security/cryptography/portfolio_encryption.html#PortfolioEncryption.decrypt_portfolio_item"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.cryptography.portfolio_encryption.PortfolioEncryption.decrypt_portfolio_item" title="Link to this definition"></a></dt>
<dd><p>Securely decrypts portfolio item data with memory protection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>encrypted_item</strong> – Encrypted portfolio data</p></li>
<li><p><strong>user_id</strong> – User identifier</p></li>
<li><p><strong>salt</strong> – Cryptographic salt</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Decrypted portfolio data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict</p>
</dd>
</dl>
<dl class="simple">
<dt>Security:</dt><dd><ul class="simple">
<li><p>Validates encrypted data integrity</p></li>
<li><p>Implements secure memory handling</p></li>
<li><p>Provides safe defaults for failures</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-security.csrf_protection">
<span id="security-csrf-protection"></span><h1>security.csrf_protection<a class="headerlink" href="#module-security.csrf_protection" title="Link to this heading"></a></h1>
<p>Enhanced CSRF Protection System
Version: 2.0
Author: Gabriel Cellammare
Last Modified: 09/01/2025</p>
<p>A comprehensive Cross-Site Request Forgery (CSRF) protection system designed for Flask applications
with emphasis on security, scalability, and compliance with modern web security standards.</p>
<p>Key Features:
1. JavaScript Origin Validation - Ensures requests originate from legitimate sources using cryptographic signatures
2. Request Origin Binding - Links tokens to specific origins and validates request chains
3. Enhanced Token Protection - Uses encryption and HMAC validation with secure token lifecycle management
4. Anti-Automation Measures - Implements rate limiting and request pattern analysis
5. Request Chain Validation - Tracks and validates request sequences to prevent replay attacks</p>
<p>Security Measures:
- Implements double-submit cookie pattern
- Uses cryptographic signatures for request validation
- Supports both development and production environments with appropriate security levels
- Includes comprehensive header security
- Implements token expiration and rotation
- Provides protection against timing attacks
- Includes DOS protection mechanisms</p>
<dl>
<dt>Usage:</dt><dd><p>from csrf_protection import CSRFProtection</p>
<p>app = Flask(__name__)
csrf = CSRFProtection(app)</p>
<p>&#64;app.route(‘/protected’, methods=[‘POST’])
&#64;csrf.csrf_protect
def protected_route():</p>
<blockquote>
<div><p>return ‘Protected endpoint’</p>
</div></blockquote>
</dd>
<dt>Dependencies:</dt><dd><ul class="simple">
<li><p>Flask</p></li>
<li><p>cryptography</p></li>
<li><p>Python 3.7+</p></li>
</ul>
</dd>
<dt>Environment Variables:</dt><dd><ul class="simple">
<li><p>FLASK_ENV: ‘development’ or ‘production’</p></li>
<li><p>DEV_ALLOWED_ORIGINS: Comma-separated list of allowed origins for development</p></li>
<li><p>PROD_ALLOWED_ORIGINS: Comma-separated list of allowed origins for production</p></li>
</ul>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="security.csrf_protection.CSRFProtection">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CSRFProtection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Flask</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/security/csrf_protection.html#CSRFProtection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.csrf_protection.CSRFProtection" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="security.csrf_protection.CSRFProtection.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Flask</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/security/csrf_protection.html#CSRFProtection.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.csrf_protection.CSRFProtection.__init__" title="Link to this definition"></a></dt>
<dd><p>Initializes Flask application with comprehensive security configurations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>app</strong> (<em>Flask</em>) – The Flask application instance to configure</p>
</dd>
</dl>
<dl class="simple">
<dt>Security Configurations:</dt><dd><ul class="simple">
<li><p>Session security settings</p></li>
<li><p>Origin validation rules</p></li>
<li><p>HTTPS enforcement</p></li>
<li><p>Security headers</p></li>
<li><p>Environment-specific configurations</p></li>
</ul>
</dd>
<dt>Environment Handling:</dt><dd><ul class="simple">
<li><p>Development: Allows local testing and ngrok domains</p></li>
<li><p>Production: Strict security controls</p></li>
</ul>
</dd>
<dt>Implementation Details:</dt><dd><ul class="simple">
<li><p>Configures session parameters</p></li>
<li><p>Sets up request hooks for HTTPS and headers</p></li>
<li><p>Initializes origin validation</p></li>
<li><p>Establishes environment-specific rate limits</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – If initialization fails, with detailed error logging</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="security.csrf_protection.CSRFProtection.init_app">
<span class="sig-name descname"><span class="pre">init_app</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Flask</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/security/csrf_protection.html#CSRFProtection.init_app"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.csrf_protection.CSRFProtection.init_app" title="Link to this definition"></a></dt>
<dd><p>Initialize application with comprehensive security configurations.</p>
<p>This method configures the Flask application with security features, sets up session
handling, and initializes OAuth providers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>app</strong> (<em>Flask</em>) – The Flask application instance to configure</p>
</dd>
</dl>
<dl class="simple">
<dt>Security Features:</dt><dd><ul class="simple">
<li><p>Session security settings</p></li>
<li><p>Origin validation rules</p></li>
<li><p>HTTPS enforcement</p></li>
<li><p>Security headers</p></li>
<li><p>Environment-specific configurations</p></li>
</ul>
</dd>
<dt>Environment Handling:</dt><dd><ul class="simple">
<li><p>Development: Allows local testing and ngrok domains</p></li>
<li><p>Production: Strict security controls</p></li>
</ul>
</dd>
<dt>Implementation Details:</dt><dd><ul class="simple">
<li><p>Configures session parameters</p></li>
<li><p>Sets up request hooks for HTTPS and headers</p></li>
<li><p>Initializes origin validation</p></li>
<li><p>Establishes environment-specific rate limits</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – If initialization fails, with detailed error logging</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="security.csrf_protection.CSRFProtection.set_csrf_cookie">
<span class="sig-name descname"><span class="pre">set_csrf_cookie</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">response</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Response</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/security/csrf_protection.html#CSRFProtection.set_csrf_cookie"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.csrf_protection.CSRFProtection.set_csrf_cookie" title="Link to this definition"></a></dt>
<dd><p>Sets CSRF token cookie with secure settings and domain binding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>response</strong> (<em>Response</em>) – Flask response object to modify</p></li>
<li><p><strong>token</strong> (<em>str</em>) – CSRF token to set in cookie</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Security Features:</dt><dd><ul class="simple">
<li><p>Secure flag enabled</p></li>
<li><p>HttpOnly flag enabled</p></li>
<li><p>SameSite attribute set to ‘Lax’</p></li>
<li><p>Domain-bound cookies</p></li>
<li><p>Appropriate expiration time</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Automatically detects and uses appropriate domain from request</p></li>
<li><p>Implements security best practices for cookie attributes</p></li>
<li><p>Handles empty token gracefully</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="security.csrf_protection.CSRFProtection.generate_token">
<span class="sig-name descname"><span class="pre">generate_token</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">require_user_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Response</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/security/csrf_protection.html#CSRFProtection.generate_token"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.csrf_protection.CSRFProtection.generate_token" title="Link to this definition"></a></dt>
<dd><p>Generate CSRF token and prepare secure response.
Now returns both token and properly configured response.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="security.csrf_protection.CSRFProtection.validate_token_request">
<span class="sig-name descname"><span class="pre">validate_token_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/security/csrf_protection.html#CSRFProtection.validate_token_request"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.csrf_protection.CSRFProtection.validate_token_request" title="Link to this definition"></a></dt>
<dd><p>Performs comprehensive validation of CSRF token and associated request headers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>token</strong> (<em>str</em>) – The CSRF token to validate</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if token and request headers pass all security checks</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
<dl class="simple">
<dt>Security Validations:</dt><dd><ul class="simple">
<li><p>Token cryptographic validation</p></li>
<li><p>Origin header verification</p></li>
<li><p>Referrer header checking for same-origin</p></li>
<li><p>Request chain validation</p></li>
<li><p>Token usage counting</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Implements defense in depth through multiple validation layers</p></li>
<li><p>Provides detailed logging for security events</p></li>
<li><p>Handles missing headers gracefully</p></li>
</ul>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">csrf</span><span class="o">.</span><span class="n">validate_token_request</span><span class="p">(</span><span class="s2">&quot;eyJhbGc...&quot;</span><span class="p">)</span>
<span class="go">True  # If token and request are valid</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="security.csrf_protection.CSRFProtection.generate_nonce">
<span class="sig-name descname"><span class="pre">generate_nonce</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/security/csrf_protection.html#CSRFProtection.generate_nonce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.csrf_protection.CSRFProtection.generate_nonce" title="Link to this definition"></a></dt>
<dd><p>Creates a cryptographically secure, single-use nonce with request binding.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Encrypted nonce containing request metadata</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
<dl class="simple">
<dt>Security Features:</dt><dd><ul class="simple">
<li><p>Bound to user session</p></li>
<li><p>Request ID integration</p></li>
<li><p>Automatic expiration</p></li>
<li><p>Protection against replay attacks</p></li>
<li><p>DOS prevention through cleanup</p></li>
</ul>
</dd>
<dt>Implementation Details:</dt><dd><ul class="simple">
<li><p>Uses Fernet symmetric encryption</p></li>
<li><p>Includes timestamp for expiration</p></li>
<li><p>Maintains maximum nonce limit</p></li>
<li><p>Implements automatic cleanup</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Abort</strong><strong>(</strong><strong>403</strong><strong>)</strong> – When JavaScript origin validation fails</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="security.csrf_protection.CSRFProtection.validate_nonce">
<span class="sig-name descname"><span class="pre">validate_nonce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nonce</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/security/csrf_protection.html#CSRFProtection.validate_nonce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.csrf_protection.CSRFProtection.validate_nonce" title="Link to this definition"></a></dt>
<dd><p>Validates nonce with comprehensive security checks and request chain verification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nonce</strong> (<em>str</em>) – The nonce string to validate</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if nonce is valid and unused</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
<dl class="simple">
<dt>Security Checks:</dt><dd><ul class="simple">
<li><p>Existence verification</p></li>
<li><p>Expiration validation</p></li>
<li><p>Payload decryption and validation</p></li>
<li><p>User session binding</p></li>
<li><p>Single-use enforcement</p></li>
</ul>
</dd>
<dt>Implementation Details:</dt><dd><ul class="simple">
<li><p>Implements one-time use pattern</p></li>
<li><p>Automatic removal after use</p></li>
<li><p>Maintains encrypted payload integrity</p></li>
<li><p>Provides detailed error logging</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Used in conjunction with token validation</p></li>
<li><p>Part of double-submit validation pattern</p></li>
<li><p>Implements defense against replay attacks</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="security.csrf_protection.CSRFProtection.csrf_protect">
<span class="sig-name descname"><span class="pre">csrf_protect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span></span></span><a class="reference internal" href="_modules/security/csrf_protection.html#CSRFProtection.csrf_protect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.csrf_protection.CSRFProtection.csrf_protect" title="Link to this definition"></a></dt>
<dd><p>Comprehensive CSRF protection decorator implementing multiple security layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>f</strong> (<em>Callable</em>) – The Flask route function to protect</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Decorated function with CSRF protection</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Callable</p>
</dd>
</dl>
<dl>
<dt>Security Layers:</dt><dd><ol class="arabic simple">
<li><p>Nonce validation</p></li>
<li><p>Token validation</p></li>
<li><p>Origin verification</p></li>
<li><p>Request chain validation</p></li>
</ol>
</dd>
<dt>Usage:</dt><dd><p>&#64;app.route(‘/api/data’, methods=[‘POST’])
&#64;csrf_protect
def protected_endpoint():</p>
<blockquote>
<div><p>return ‘Protected data’</p>
</div></blockquote>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Abort</strong><strong>(</strong><strong>403</strong><strong>)</strong> – When any security check fails
    - Invalid or missing nonce
    - Invalid or missing token
    - Invalid origin
    - Failed request chain validation</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-security.input_validator">
<span id="security-input-validator"></span><h1>security.input_validator<a class="headerlink" href="#module-security.input_validator" title="Link to this heading"></a></h1>
<p>Enhanced Input Validation System
Version: 1.0
Author: Gabriel Cellammare
Last Modified: 05/01/2025</p>
<p>This module implements a comprehensive input validation system with strong focus on
security, data sanitization, and protection against common web vulnerabilities.</p>
<p>Security Features:
1. Input Sanitization</p>
<blockquote>
<div><ul class="simple">
<li><p>NoSQL injection prevention</p></li>
<li><p>XSS protection</p></li>
<li><p>HTML encoding</p></li>
<li><p>Special character handling</p></li>
<li><p>Data type validation</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Validation Protection
- Strict type checking
- Pattern validation
- Range validation
- Length constraints
- Custom validation hooks</p></li>
<li><p>Data Security
- Protected field handling
- Safe type conversion
- Secure date parsing
- Protected numeric operations
- Field access control</p></li>
<li><p>Error Management
- Secure error reporting
- Non-revealing messages
- Protected validation state
- Safe error recovery</p></li>
</ol>
<p>Security Considerations:
- All input is sanitized before processing
- Pattern matching is strictly controlled
- Type conversions are handled securely
- Error messages don’t leak internal details
- Validation rules are immutable
- Date ranges are strictly enforced
- Numeric values are bounded
- Custom validators are protected</p>
<p>Dependencies:
- validators: For email and URL validation
- datetime: For secure date handling
- re: For pattern matching
- typing: For type validation</p>
<dl class="py exception">
<dt class="sig sig-object py" id="security.input_validator.ValidationError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ValidationError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/security/input_validator.html#ValidationError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.input_validator.ValidationError" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Secure exception class for validation errors.</p>
<p>Security Features:
- Sanitized error messages
- Protected field names
- Safe string representation</p>
<dl class="py method">
<dt class="sig sig-object py" id="security.input_validator.ValidationError.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/security/input_validator.html#ValidationError.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.input_validator.ValidationError.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="security.input_validator.InputType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">InputType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names=&lt;not</span> <span class="pre">given&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qualname=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/security/input_validator.html#InputType"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.input_validator.InputType" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<p>Secure enumeration of allowed input types.</p>
<p>Security Features:
- Immutable type definitions
- Protected value access
- Controlled type expansion</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="security.input_validator.InputType.STRING">
<span class="sig-name descname"><span class="pre">STRING</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'string'</span></em><a class="headerlink" href="#security.input_validator.InputType.STRING" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="security.input_validator.InputType.NUMBER">
<span class="sig-name descname"><span class="pre">NUMBER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'number'</span></em><a class="headerlink" href="#security.input_validator.InputType.NUMBER" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="security.input_validator.InputType.DATE">
<span class="sig-name descname"><span class="pre">DATE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'date'</span></em><a class="headerlink" href="#security.input_validator.InputType.DATE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="security.input_validator.InputType.EMAIL">
<span class="sig-name descname"><span class="pre">EMAIL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'email'</span></em><a class="headerlink" href="#security.input_validator.InputType.EMAIL" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="security.input_validator.InputType.URL">
<span class="sig-name descname"><span class="pre">URL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'url'</span></em><a class="headerlink" href="#security.input_validator.InputType.URL" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="security.input_validator.InputType.CRYPTO_ID">
<span class="sig-name descname"><span class="pre">CRYPTO_ID</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'crypto_id'</span></em><a class="headerlink" href="#security.input_validator.InputType.CRYPTO_ID" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="security.input_validator.InputType.CURRENCY">
<span class="sig-name descname"><span class="pre">CURRENCY</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'currency'</span></em><a class="headerlink" href="#security.input_validator.InputType.CURRENCY" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="security.input_validator.InputType.JWT">
<span class="sig-name descname"><span class="pre">JWT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'jwt'</span></em><a class="headerlink" href="#security.input_validator.InputType.JWT" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="security.input_validator.ValidationRule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ValidationRule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">required</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#security.input_validator.InputType" title="security.input_validator.InputType"><span class="pre">InputType</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">InputType.STRING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allowed_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_validator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/security/input_validator.html#ValidationRule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.input_validator.ValidationRule" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Immutable validation rule configuration.</p>
<p>Security Features:
- Frozen dataclass prevents modification
- Type-checked attributes
- Protected validator references</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="security.input_validator.ValidationRule.required">
<span class="sig-name descname"><span class="pre">required</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#security.input_validator.ValidationRule.required" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="security.input_validator.ValidationRule.type">
<span class="sig-name descname"><span class="pre">type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#security.input_validator.InputType" title="security.input_validator.InputType"><span class="pre">InputType</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'string'</span></em><a class="headerlink" href="#security.input_validator.ValidationRule.type" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="security.input_validator.ValidationRule.min_length">
<span class="sig-name descname"><span class="pre">min_length</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#security.input_validator.ValidationRule.min_length" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="security.input_validator.ValidationRule.max_length">
<span class="sig-name descname"><span class="pre">max_length</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#security.input_validator.ValidationRule.max_length" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="security.input_validator.ValidationRule.min_value">
<span class="sig-name descname"><span class="pre">min_value</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#security.input_validator.ValidationRule.min_value" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="security.input_validator.ValidationRule.max_value">
<span class="sig-name descname"><span class="pre">max_value</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#security.input_validator.ValidationRule.max_value" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="security.input_validator.ValidationRule.pattern">
<span class="sig-name descname"><span class="pre">pattern</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#security.input_validator.ValidationRule.pattern" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="security.input_validator.ValidationRule.allowed_values">
<span class="sig-name descname"><span class="pre">allowed_values</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#security.input_validator.ValidationRule.allowed_values" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="security.input_validator.ValidationRule.custom_validator">
<span class="sig-name descname"><span class="pre">custom_validator</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#security.input_validator.ValidationRule.custom_validator" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="security.input_validator.ValidationRule.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">required</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#security.input_validator.InputType" title="security.input_validator.InputType"><span class="pre">InputType</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">InputType.STRING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allowed_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_validator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#security.input_validator.ValidationRule.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="security.input_validator.InputValidator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">InputValidator</span></span><a class="reference internal" href="_modules/security/input_validator.html#InputValidator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.input_validator.InputValidator" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Secure input validation system with comprehensive protection against common vulnerabilities.</p>
<p>Security Features:
- Input sanitization
- Type validation
- Pattern matching
- Range checking
- Custom validation hooks</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="security.input_validator.InputValidator.PATTERNS">
<span class="sig-name descname"><span class="pre">PATTERNS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'crypto_id':</span> <span class="pre">'^[a-z0-9-]+$',</span> <span class="pre">'currency':</span> <span class="pre">'^[A-Z]{3}$',</span> <span class="pre">'jwt':</span> <span class="pre">'^[A-Za-z0-9-_=]+\\.[A-Za-z0-9-_=]+\\.?[A-Za-z0-9-_.+/=]*$'}</span></em><a class="headerlink" href="#security.input_validator.InputValidator.PATTERNS" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="security.input_validator.InputValidator.COMMON_RULES">
<span class="sig-name descname"><span class="pre">COMMON_RULES</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'auth':</span> <span class="pre">{'code':</span> <span class="pre">ValidationRule(required=True,</span> <span class="pre">type=&lt;InputType.STRING:</span> <span class="pre">'string'&gt;,</span> <span class="pre">min_length=20,</span> <span class="pre">max_length=None,</span> <span class="pre">min_value=None,</span> <span class="pre">max_value=None,</span> <span class="pre">pattern=None,</span> <span class="pre">allowed_values=None,</span> <span class="pre">custom_validator=None),</span> <span class="pre">'provider':</span> <span class="pre">ValidationRule(required=True,</span> <span class="pre">type=&lt;InputType.STRING:</span> <span class="pre">'string'&gt;,</span> <span class="pre">min_length=None,</span> <span class="pre">max_length=None,</span> <span class="pre">min_value=None,</span> <span class="pre">max_value=None,</span> <span class="pre">pattern=None,</span> <span class="pre">allowed_values=['google',</span> <span class="pre">'github'],</span> <span class="pre">custom_validator=None),</span> <span class="pre">'state':</span> <span class="pre">ValidationRule(required=True,</span> <span class="pre">type=&lt;InputType.STRING:</span> <span class="pre">'string'&gt;,</span> <span class="pre">min_length=32,</span> <span class="pre">max_length=64,</span> <span class="pre">min_value=None,</span> <span class="pre">max_value=None,</span> <span class="pre">pattern=None,</span> <span class="pre">allowed_values=None,</span> <span class="pre">custom_validator=None)},</span> <span class="pre">'currency_preference':</span> <span class="pre">{'currency':</span> <span class="pre">ValidationRule(required=True,</span> <span class="pre">type=&lt;InputType.CURRENCY:</span> <span class="pre">'currency'&gt;,</span> <span class="pre">min_length=None,</span> <span class="pre">max_length=None,</span> <span class="pre">min_value=None,</span> <span class="pre">max_value=None,</span> <span class="pre">pattern='^[A-Z]{3}$',</span> <span class="pre">allowed_values=['USD',</span> <span class="pre">'EUR'],</span> <span class="pre">custom_validator=None)},</span> <span class="pre">'portfolio_add':</span> <span class="pre">{'amount':</span> <span class="pre">ValidationRule(required=True,</span> <span class="pre">type=&lt;InputType.NUMBER:</span> <span class="pre">'number'&gt;,</span> <span class="pre">min_length=None,</span> <span class="pre">max_length=None,</span> <span class="pre">min_value=1e-07,</span> <span class="pre">max_value=None,</span> <span class="pre">pattern=None,</span> <span class="pre">allowed_values=None,</span> <span class="pre">custom_validator=None),</span> <span class="pre">'crypto_id':</span> <span class="pre">ValidationRule(required=True,</span> <span class="pre">type=&lt;InputType.CRYPTO_ID:</span> <span class="pre">'crypto_id'&gt;,</span> <span class="pre">min_length=None,</span> <span class="pre">max_length=None,</span> <span class="pre">min_value=None,</span> <span class="pre">max_value=None,</span> <span class="pre">pattern='^[a-z0-9-]+$',</span> <span class="pre">allowed_values=None,</span> <span class="pre">custom_validator=None),</span> <span class="pre">'purchase_date':</span> <span class="pre">ValidationRule(required=True,</span> <span class="pre">type=&lt;InputType.DATE:</span> <span class="pre">'date'&gt;,</span> <span class="pre">min_length=None,</span> <span class="pre">max_length=None,</span> <span class="pre">min_value=None,</span> <span class="pre">max_value=None,</span> <span class="pre">pattern=None,</span> <span class="pre">allowed_values=None,</span> <span class="pre">custom_validator=None),</span> <span class="pre">'purchase_price':</span> <span class="pre">ValidationRule(required=True,</span> <span class="pre">type=&lt;InputType.NUMBER:</span> <span class="pre">'number'&gt;,</span> <span class="pre">min_length=None,</span> <span class="pre">max_length=None,</span> <span class="pre">min_value=0,</span> <span class="pre">max_value=None,</span> <span class="pre">pattern=None,</span> <span class="pre">allowed_values=None,</span> <span class="pre">custom_validator=None),</span> <span class="pre">'symbol':</span> <span class="pre">ValidationRule(required=True,</span> <span class="pre">type=&lt;InputType.STRING:</span> <span class="pre">'string'&gt;,</span> <span class="pre">min_length=1,</span> <span class="pre">max_length=10,</span> <span class="pre">min_value=None,</span> <span class="pre">max_value=None,</span> <span class="pre">pattern=None,</span> <span class="pre">allowed_values=None,</span> <span class="pre">custom_validator=None)},</span> <span class="pre">'portfolio_update':</span> <span class="pre">{'amount':</span> <span class="pre">ValidationRule(required=True,</span> <span class="pre">type=&lt;InputType.NUMBER:</span> <span class="pre">'number'&gt;,</span> <span class="pre">min_length=None,</span> <span class="pre">max_length=None,</span> <span class="pre">min_value=1e-07,</span> <span class="pre">max_value=None,</span> <span class="pre">pattern=None,</span> <span class="pre">allowed_values=None,</span> <span class="pre">custom_validator=None),</span> <span class="pre">'purchase_date':</span> <span class="pre">ValidationRule(required=True,</span> <span class="pre">type=&lt;InputType.DATE:</span> <span class="pre">'date'&gt;,</span> <span class="pre">min_length=None,</span> <span class="pre">max_length=None,</span> <span class="pre">min_value=None,</span> <span class="pre">max_value=None,</span> <span class="pre">pattern=None,</span> <span class="pre">allowed_values=None,</span> <span class="pre">custom_validator=None),</span> <span class="pre">'purchase_price':</span> <span class="pre">ValidationRule(required=True,</span> <span class="pre">type=&lt;InputType.NUMBER:</span> <span class="pre">'number'&gt;,</span> <span class="pre">min_length=None,</span> <span class="pre">max_length=None,</span> <span class="pre">min_value=0,</span> <span class="pre">max_value=None,</span> <span class="pre">pattern=None,</span> <span class="pre">allowed_values=None,</span> <span class="pre">custom_validator=None)}}</span></em><a class="headerlink" href="#security.input_validator.InputValidator.COMMON_RULES" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="security.input_validator.InputValidator.MIN_ALLOWED_DATE">
<span class="sig-name descname"><span class="pre">MIN_ALLOWED_DATE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">datetime.datetime(2010,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">0,</span> <span class="pre">0)</span></em><a class="headerlink" href="#security.input_validator.InputValidator.MIN_ALLOWED_DATE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="security.input_validator.InputValidator.sanitize_input">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sanitize_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/security/input_validator.html#InputValidator.sanitize_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.input_validator.InputValidator.sanitize_input" title="Link to this definition"></a></dt>
<dd><p>Securely sanitize string input to prevent injection attacks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> – Input string to sanitize</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sanitized string safe for processing</p>
</dd>
</dl>
<p>Security measures:
- NoSQL operator removal
- HTML character encoding
- Special character handling
- Type checking</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="security.input_validator.InputValidator.validate_value">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">validate_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rule</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#security.input_validator.ValidationRule" title="security.input_validator.ValidationRule"><span class="pre">ValidationRule</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="_modules/security/input_validator.html#InputValidator.validate_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.input_validator.InputValidator.validate_value" title="Link to this definition"></a></dt>
<dd><p>Securely validate a single value against defined rules.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> – Input value to validate</p></li>
<li><p><strong>rule</strong> – ValidationRule to apply</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Validated and potentially transformed value</p>
</dd>
</dl>
<p>Security measures:
- Type validation
- Range checking
- Pattern matching
- Custom validation protection</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="security.input_validator.InputValidator.validate_request_data">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">validate_request_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rules</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#security.input_validator.ValidationRule" title="security.input_validator.ValidationRule"><span class="pre">ValidationRule</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/security/input_validator.html#InputValidator.validate_request_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.input_validator.InputValidator.validate_request_data" title="Link to this definition"></a></dt>
<dd><p>Securely validate complete request data against defined rules.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Dictionary of input data</p></li>
<li><p><strong>rules</strong> – Dictionary of validation rules</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of validated data</p>
</dd>
</dl>
<p>Security measures:
- Unknown field detection
- Complete validation coverage
- Protected field access
- Secure type conversion</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="security.input_validator.InputValidator.validate_portfolio_add">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">validate_portfolio_add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/security/input_validator.html#InputValidator.validate_portfolio_add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.input_validator.InputValidator.validate_portfolio_add" title="Link to this definition"></a></dt>
<dd><p>Secure validation for portfolio additions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="security.input_validator.InputValidator.validate_auth">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">validate_auth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/security/input_validator.html#InputValidator.validate_auth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.input_validator.InputValidator.validate_auth" title="Link to this definition"></a></dt>
<dd><p>Secure validation for authentication data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="security.input_validator.InputValidator.validate_currency_preference">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">validate_currency_preference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/security/input_validator.html#InputValidator.validate_currency_preference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.input_validator.InputValidator.validate_currency_preference" title="Link to this definition"></a></dt>
<dd><p>Secure validation for currency preferences.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-security.rate_limiter">
<span id="security-rate-limiter"></span><h1>security.rate_limiter<a class="headerlink" href="#module-security.rate_limiter" title="Link to this heading"></a></h1>
<p>FirebaseRateLimiter: Distributed Rate Limiting Implementation
Version: 1.0
Author: [Gabriel Cellammare]
Last Modified: [05/01/2025]</p>
<p>This module provides a distributed rate limiting solution using Firebase Firestore:
- Scalable rate limiting across multiple instances
- Automatic cleanup of expired entries
- Transaction-based atomic operations
- Probabilistic maintenance</p>
<p>Security Features:
1. Transaction-based updates
2. Automatic data cleanup
3. Error handling and logging
4. Atomic operations
5. Time-window based limiting</p>
<p>Dependencies:
- firebase_admin.firestore
- flask.current_app
- logging
- time
- random</p>
<dl class="py class">
<dt class="sig sig-object py" id="security.rate_limiter.FirebaseRateLimitCleaner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FirebaseRateLimitCleaner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collection_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'rate_limits'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/security/rate_limiter.html#FirebaseRateLimitCleaner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.rate_limiter.FirebaseRateLimitCleaner" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Cleanup Manager for Rate Limiting Data</p>
<p>Handles the periodic cleanup of expired rate limiting entries:
- Batch processing to avoid timeouts
- Configurable window sizes
- Error handling and logging</p>
<p>Security Features:
- Batched operations
- Error isolation
- Logging of operations</p>
<dl class="py method">
<dt class="sig sig-object py" id="security.rate_limiter.FirebaseRateLimitCleaner.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collection_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'rate_limits'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/security/rate_limiter.html#FirebaseRateLimitCleaner.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.rate_limiter.FirebaseRateLimitCleaner.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize the rate limit cleaner.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db</strong> – Firestore client instance</p></li>
<li><p><strong>collection_name</strong> – Collection name for rate limits</p></li>
</ul>
</dd>
</dl>
<p>Security:
- Validates inputs
- Configures logging</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="security.rate_limiter.FirebaseRateLimitCleaner.clean_expired_entries">
<span class="sig-name descname"><span class="pre">clean_expired_entries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window_seconds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3600</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">500</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/security/rate_limiter.html#FirebaseRateLimitCleaner.clean_expired_entries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.rate_limiter.FirebaseRateLimitCleaner.clean_expired_entries" title="Link to this definition"></a></dt>
<dd><p>Remove expired rate limit entries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>window_seconds</strong> – Time window in seconds</p></li>
<li><p><strong>batch_size</strong> – Number of documents per batch</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Number of deleted documents</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
<p>Security:
- Batched operations
- Transaction safety
- Error handling</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="security.rate_limiter.FirebaseRateLimiter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FirebaseRateLimiter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_requests</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_seconds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3600</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ip_max_requests</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ip_window_seconds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3600</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cleanup_probability</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/security/rate_limiter.html#FirebaseRateLimiter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.rate_limiter.FirebaseRateLimiter" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="security.rate_limiter.FirebaseRateLimiter.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_requests</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_seconds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3600</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ip_max_requests</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ip_window_seconds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3600</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cleanup_probability</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/security/rate_limiter.html#FirebaseRateLimiter.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.rate_limiter.FirebaseRateLimiter.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize rate limiter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db</strong> – Firestore database instance</p></li>
<li><p><strong>max_requests</strong> – Maximum requests per user window</p></li>
<li><p><strong>window_seconds</strong> – Time window for user limits</p></li>
<li><p><strong>ip_max_requests</strong> – Maximum requests per IP window</p></li>
<li><p><strong>ip_window_seconds</strong> – Time window for IP limits</p></li>
</ul>
</dd>
</dl>
<p>Security:
- Input validation
- Configuration logging
- Cleanup initialization</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="security.rate_limiter.FirebaseRateLimiter.maybe_cleanup">
<span class="sig-name descname"><span class="pre">maybe_cleanup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/security/rate_limiter.html#FirebaseRateLimiter.maybe_cleanup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.rate_limiter.FirebaseRateLimiter.maybe_cleanup" title="Link to this definition"></a></dt>
<dd><p>Probabilistic cleanup execution.</p>
<p>Security:
- Error isolation
- Logging
- Non-blocking operation</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="security.rate_limiter.FirebaseRateLimiter.check_rate_limit">
<span class="sig-name descname"><span class="pre">check_rate_limit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ip_address</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/security/rate_limiter.html#FirebaseRateLimiter.check_rate_limit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.rate_limiter.FirebaseRateLimiter.check_rate_limit" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-security.secure_bye_array">
<span id="security-secure-bye-array"></span><h1>security.secure_bye_array<a class="headerlink" href="#module-security.secure_bye_array" title="Link to this heading"></a></h1>
<p>SecureByteArray: Secure Memory Management Implementation
Version: 1.0
Author: [Gabriel Cellammare]
Last Modified: [05/01/2025]</p>
<p>This module provides a secure implementation for handling sensitive data in memory with:
- Protected memory management
- Anti-dumping measures
- Secure data wiping
- Automatic cleanup mechanisms</p>
<p>Security Features:
1. Memory Protection: Implements secure allocation and wiping
2. Anti-Dumping: Uses multiple overwrite passes
3. Context Management: Automatic cleanup
4. Access Control: Locking mechanism
5. Secure Random: Uses secrets module for cryptographic operations</p>
<p>Dependencies:
- array (for byte array management)
- ctypes (for low-level memory operations)
- secrets (for cryptographic random generation)
- logging (for security event tracking)</p>
<dl class="py exception">
<dt class="sig sig-object py" id="security.secure_bye_array.MemorySecurityError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MemorySecurityError</span></span><a class="reference internal" href="_modules/security/secure_bye_array.html#MemorySecurityError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.secure_bye_array.MemorySecurityError" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Custom exception for memory security operations.</p>
<p>Used to distinguish memory security issues from standard exceptions.
Provides specific error context for security-related failures.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="security.secure_bye_array.SecureByteArray">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SecureByteArray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytearray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/security/secure_bye_array.html#SecureByteArray"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.secure_bye_array.SecureByteArray" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Secure Memory Management Implementation</p>
<p>Provides protected memory operations for sensitive data handling:
- Secure memory allocation and deallocation
- Protection against memory dumps
- Multi-pass secure data wiping
- Automatic memory cleanup
- Memory access controls</p>
<p>Security Features:
- Uses cryptographic random for overwriting
- Implements multiple wipe passes
- Verifies memory allocation
- Provides memory locking
- Implements secure copying</p>
<dl>
<dt>Usage:</dt><dd><p># Using as context manager (recommended)
with SecureByteArray(sensitive_data) as secure_data:</p>
<blockquote>
<div><p>processed_data = secure_data.to_bytes()</p>
</div></blockquote>
<p># Direct usage (requires manual cleanup)
secure_data = SecureByteArray(sensitive_data)
try:</p>
<blockquote>
<div><p>processed_data = secure_data.to_bytes()</p>
</div></blockquote>
<dl class="simple">
<dt>finally:</dt><dd><p>secure_data.secure_zero()</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="security.secure_bye_array.SecureByteArray.logger">
<span class="sig-name descname"><span class="pre">logger</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">security.secure_bye_array</span> <span class="pre">(INFO)&gt;</span></em><a class="headerlink" href="#security.secure_bye_array.SecureByteArray.logger" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="security.secure_bye_array.SecureByteArray.SECURE_WIPE_PASSES">
<span class="sig-name descname"><span class="pre">SECURE_WIPE_PASSES</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#security.secure_bye_array.SecureByteArray.SECURE_WIPE_PASSES" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="security.secure_bye_array.SecureByteArray.MIN_RANDOM_BYTES">
<span class="sig-name descname"><span class="pre">MIN_RANDOM_BYTES</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">32</span></em><a class="headerlink" href="#security.secure_bye_array.SecureByteArray.MIN_RANDOM_BYTES" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="security.secure_bye_array.SecureByteArray.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytearray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/security/secure_bye_array.html#SecureByteArray.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.secure_bye_array.SecureByteArray.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize secure byte array with optional data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> – Initial sensitive data (optional)</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="#security.secure_bye_array.MemorySecurityError" title="security.secure_bye_array.MemorySecurityError"><strong>MemorySecurityError</strong></a> – On memory allocation failure</p></li>
<li><p><strong>TypeError</strong> – On invalid input data type</p></li>
</ul>
</dd>
</dl>
<p>Security:
- Validates input types
- Verifies memory allocation
- Initializes security state</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="security.secure_bye_array.SecureByteArray.secure_zero">
<span class="sig-name descname"><span class="pre">secure_zero</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/security/secure_bye_array.html#SecureByteArray.secure_zero"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.secure_bye_array.SecureByteArray.secure_zero" title="Link to this definition"></a></dt>
<dd><p>Securely wipe memory contents.</p>
<p>Security Implementation:
- Multiple overwrite passes
- Cryptographic random data
- Final zero overwrite
- Memory fence operations</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#security.secure_bye_array.MemorySecurityError" title="security.secure_bye_array.MemorySecurityError"><strong>MemorySecurityError</strong></a> – If secure wiping fails</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="security.secure_bye_array.SecureByteArray.to_bytes">
<span class="sig-name descname"><span class="pre">to_bytes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bytes</span></span></span><a class="reference internal" href="_modules/security/secure_bye_array.html#SecureByteArray.to_bytes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#security.secure_bye_array.SecureByteArray.to_bytes" title="Link to this definition"></a></dt>
<dd><p>Create secure copy of data.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Copy of protected data</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bytes</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#security.secure_bye_array.MemorySecurityError" title="security.secure_bye_array.MemorySecurityError"><strong>MemorySecurityError</strong></a> – If array is locked</p>
</dd>
</dl>
<p>Security:
- Validates lock state
- Creates secure copy
- Maintains original protection</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-utils.cryptocache">
<span id="utils-cryptocache"></span><h1>utils.cryptocache<a class="headerlink" href="#module-utils.cryptocache" title="Link to this heading"></a></h1>
<p>CryptoCache: Advanced Cryptocurrency Data Security Framework
Version: 1.0
Author: Gabriel Cellammare
Last Modified: 05/01/2025</p>
<p>This module implements a comprehensive security framework for caching cryptocurrency
pricing data with defense-in-depth measures and robust security controls. It provides
multi-layered protection against various attack vectors while ensuring data integrity
and secure API communications.</p>
<p>Core Security Features:</p>
<ol class="arabic simple">
<li><p>Data Protection
- Secure cache file handling
- Data validation and sanitization
- Protected memory operations
- Integrity verification</p></li>
<li><p>API Security
- Rate limiting implementation
- Request throttling
- Secure HTTP headers
- Response validation</p></li>
<li><p>Cache Management
- Secure directory creation
- Protected file operations
- Timestamp validation
- Data expiration controls</p></li>
<li><p>Error Handling
- Comprehensive exception management
- Secure logging practices
- Fail-safe defaults
- Recovery procedures</p></li>
</ol>
<p>Security Considerations:</p>
<ol class="arabic simple">
<li><p>File System Security:
- Cache directory permissions must be properly configured
- File operations need atomic write protection
- Path traversal prevention required
- Temporary file handling must be secure</p></li>
<li><p>API Communication:
- SSL/TLS verification should be enforced
- API keys need secure storage
- Request headers should be sanitized
- Rate limiting must prevent DOS</p></li>
<li><p>Data Validation:
- All input parameters require validation
- Cache data must be verified
- Response data needs sanitization
- Type checking should be strict</p></li>
<li><p>Memory Management:
- Sensitive data needs secure cleanup
- Memory limits should be enforced
- Large objects require streaming
- Garbage collection timing matters</p></li>
</ol>
<p>Dependencies:
- requests: HTTP client with security features
- pathlib: Secure path operations
- json: Data serialization
- logging: Security event tracking
- dotenv: Environment management
- hashlib: Cryptographic operations</p>
<dl class="py exception">
<dt class="sig sig-object py" id="utils.cryptocache.SecurityError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SecurityError</span></span><a class="reference internal" href="_modules/utils/cryptocache.html#SecurityError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.cryptocache.SecurityError" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Custom exception for security-related errors</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.cryptocache.initialize_environment">
<span class="sig-name descname"><span class="pre">initialize_environment</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="_modules/utils/cryptocache.html#initialize_environment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.cryptocache.initialize_environment" title="Link to this definition"></a></dt>
<dd><p>Initialize and validate environment variables</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Configuration dictionary containing validated environment variables</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>EnvironmentError</strong> – If required environment variables are missing</p></li>
<li><p><a class="reference internal" href="#utils.cryptocache.SecurityError" title="utils.cryptocache.SecurityError"><strong>SecurityError</strong></a> – If environment variables contain invalid values</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="utils.cryptocache.CryptoCache">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CryptoCache</span></span><a class="reference internal" href="_modules/utils/cryptocache.html#CryptoCache"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.cryptocache.CryptoCache" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A cryptocurrency data caching system that provides secure data retrieval and storage.
Implements rate limiting, input validation, and proper error handling.</p>
<dl class="py method">
<dt class="sig sig-object py" id="utils.cryptocache.CryptoCache.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/cryptocache.html#CryptoCache.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.cryptocache.CryptoCache.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize CryptoCache with configuration from environment variables</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference internal" href="#utils.cryptocache.SecurityError" title="utils.cryptocache.SecurityError"><strong>SecurityError</strong></a> – If security requirements are not met</p></li>
<li><p><strong>EnvironmentError</strong> – If required configuration is missing</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.cryptocache.CryptoCache.get_available_cryptocurrencies">
<span class="sig-name descname"><span class="pre">get_available_cryptocurrencies</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/utils/cryptocache.html#CryptoCache.get_available_cryptocurrencies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.cryptocache.CryptoCache.get_available_cryptocurrencies" title="Link to this definition"></a></dt>
<dd><p>Retrieve list of available cryptocurrencies with market data</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>List of cryptocurrency information including:</dt><dd><ul class="simple">
<li><p>id: Unique identifier</p></li>
<li><p>symbol: Trading symbol (uppercase)</p></li>
<li><p>name: Full name</p></li>
<li><p>current_price: Current price in USD</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>List[Dict]</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>RequestException</strong> – If API request fails</p></li>
<li><p><a class="reference internal" href="#utils.cryptocache.SecurityError" title="utils.cryptocache.SecurityError"><strong>SecurityError</strong></a> – If data validation fails</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.cryptocache.CryptoCache.get_crypto_prices">
<span class="sig-name descname"><span class="pre">get_crypto_prices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crypto_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">currency</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'USD'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="_modules/utils/cryptocache.html#CryptoCache.get_crypto_prices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.cryptocache.CryptoCache.get_crypto_prices" title="Link to this definition"></a></dt>
<dd><p>Get current cryptocurrency prices for specified currencies</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>crypto_ids</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – List of cryptocurrency IDs to fetch</p></li>
<li><p><strong>currency</strong> (<em>str</em>) – Target currency for prices (default: USD)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl>
<dt>Dictionary mapping crypto IDs to their prices in the specified currency</dt><dd><dl class="simple">
<dt>Format: {</dt><dd><p>‘bitcoin’: {‘usd’: 50000.00},
‘ethereum’: {‘usd’: 3000.00}</p>
</dd>
</dl>
<p>}</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="#utils.cryptocache.SecurityError" title="utils.cryptocache.SecurityError"><strong>SecurityError</strong></a> – If input validation fails</p></li>
<li><p><strong>RequestException</strong> – If API request fails</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.cryptocache.CryptoCache.get_exchange_rate">
<span class="sig-name descname"><span class="pre">get_exchange_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">from_currency</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'USD'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_currency</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'EUR'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/utils/cryptocache.html#CryptoCache.get_exchange_rate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.cryptocache.CryptoCache.get_exchange_rate" title="Link to this definition"></a></dt>
<dd><p>Get exchange rate between two currencies</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_currency</strong> (<em>str</em>) – Source currency code (default: USD)</p></li>
<li><p><strong>to_currency</strong> (<em>str</em>) – Target currency code (default: EUR)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Exchange rate from source to target currency</dt><dd><p>Returns 1.0 if request fails</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.cryptocache.CryptoCache.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="_modules/utils/cryptocache.html#CryptoCache.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.cryptocache.CryptoCache.get" title="Link to this definition"></a></dt>
<dd><p>Retrieve and validate cached data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> (<em>str</em>) – Cache key to retrieve</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Cached value if valid and not expired, None otherwise</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Dict]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.cryptocache.CryptoCache.set">
<span class="sig-name descname"><span class="pre">set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/utils/cryptocache.html#CryptoCache.set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.cryptocache.CryptoCache.set" title="Link to this definition"></a></dt>
<dd><p>Store data in cache</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>str</em>) – Cache key</p></li>
<li><p><strong>value</strong> – Value to cache</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#utils.cryptocache.SecurityError" title="utils.cryptocache.SecurityError"><strong>SecurityError</strong></a> – If cache write fails</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-utils.portfolio_utils">
<span id="utils-portfolio-utils"></span><h1>utils.portfolio_utils<a class="headerlink" href="#module-utils.portfolio_utils" title="Link to this heading"></a></h1>
<p>Enhanced Portfolio Metrics Calculator
Version: 2.0
Author: [Gabriel Cellammare]
Last Modified: [05/01/2025]</p>
<p>This module provides precise financial calculations for cryptocurrency portfolio analysis
with comprehensive error handling, input validation, and proper decimal arithmetic.</p>
<p>Financial Calculation Features:
1. Decimal-based precise numerical handling
2. Comprehensive error handling
3. Robust input validation
4. Proper logging
5. Currency validation
6. Threshold-based zero handling
7. Controlled numerical precision
8. Explicit error states</p>
<p>Dependencies:
- decimal: For precise numerical calculations
- logging: For proper error tracking
- typing: For type hints</p>
<dl class="py class">
<dt class="sig sig-object py" id="utils.portfolio_utils.Currency">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Currency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names=&lt;not</span> <span class="pre">given&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qualname=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/portfolio_utils.html#Currency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.portfolio_utils.Currency" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<p>Valid currency denominations</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="utils.portfolio_utils.Currency.USD">
<span class="sig-name descname"><span class="pre">USD</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'USD'</span></em><a class="headerlink" href="#utils.portfolio_utils.Currency.USD" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="utils.portfolio_utils.Currency.EUR">
<span class="sig-name descname"><span class="pre">EUR</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'EUR'</span></em><a class="headerlink" href="#utils.portfolio_utils.Currency.EUR" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="utils.portfolio_utils.PortfolioCalculationError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PortfolioCalculationError</span></span><a class="reference internal" href="_modules/utils/portfolio_utils.html#PortfolioCalculationError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.portfolio_utils.PortfolioCalculationError" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Base exception for portfolio calculation errors</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="utils.portfolio_utils.InvalidInputError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">InvalidInputError</span></span><a class="reference internal" href="_modules/utils/portfolio_utils.html#InvalidInputError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.portfolio_utils.InvalidInputError" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#utils.portfolio_utils.PortfolioCalculationError" title="utils.portfolio_utils.PortfolioCalculationError"><code class="xref py py-class docutils literal notranslate"><span class="pre">PortfolioCalculationError</span></code></a></p>
<p>Exception for invalid input data</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="utils.portfolio_utils.CurrencyError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CurrencyError</span></span><a class="reference internal" href="_modules/utils/portfolio_utils.html#CurrencyError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.portfolio_utils.CurrencyError" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#utils.portfolio_utils.PortfolioCalculationError" title="utils.portfolio_utils.PortfolioCalculationError"><code class="xref py py-class docutils literal notranslate"><span class="pre">PortfolioCalculationError</span></code></a></p>
<p>Exception for currency-related errors</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.portfolio_utils.validate_numeric_input">
<span class="sig-name descname"><span class="pre">validate_numeric_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Decimal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Decimal</span></span></span><a class="reference internal" href="_modules/utils/portfolio_utils.html#validate_numeric_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.portfolio_utils.validate_numeric_input" title="Link to this definition"></a></dt>
<dd><p>Validate and convert numeric input to Decimal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> – The value to validate</p></li>
<li><p><strong>field_name</strong> – Name of the field for error messages</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The validated and converted value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Decimal</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#utils.portfolio_utils.InvalidInputError" title="utils.portfolio_utils.InvalidInputError"><strong>InvalidInputError</strong></a> – If value is invalid</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.portfolio_utils.validate_currency">
<span class="sig-name descname"><span class="pre">validate_currency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">currency</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/utils/portfolio_utils.html#validate_currency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.portfolio_utils.validate_currency" title="Link to this definition"></a></dt>
<dd><p>Validate currency denomination.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>currency</strong> – Currency code to validate</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Validated currency code</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#utils.portfolio_utils.CurrencyError" title="utils.portfolio_utils.CurrencyError"><strong>CurrencyError</strong></a> – If currency is invalid</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.portfolio_utils.calculate_portfolio_metrics">
<span class="sig-name descname"><span class="pre">calculate_portfolio_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">portfolio_item</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Decimal</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_price</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Decimal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">currency</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'USD'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Decimal</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/utils/portfolio_utils.html#calculate_portfolio_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.portfolio_utils.calculate_portfolio_metrics" title="Link to this definition"></a></dt>
<dd><p>Calculate Financial Metrics for Portfolio Position with precise decimal arithmetic.</p>
<p>Processes a portfolio position and calculates key financial metrics
including current value, profit/loss, and percentage returns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>portfolio_item</strong> – Portfolio position containing:
- amount: Asset quantity
- purchase_price: Entry price</p></li>
<li><p><strong>current_price</strong> – Current market price</p></li>
<li><p><strong>currency</strong> – Currency denomination (default: ‘USD’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Financial metrics including:</dt><dd><ul class="simple">
<li><p>current_price: Market price</p></li>
<li><p>current_value: Position value</p></li>
<li><p>profit_loss: Absolute P/L</p></li>
<li><p>profit_loss_percentage: Relative P/L</p></li>
<li><p>currency: Denomination currency</p></li>
<li><p>error: Error message if calculation failed</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p>Financial Safety:
- Decimal arithmetic for precision
- Comprehensive input validation
- Specific error handling
- Proper logging
- Currency validation
- Threshold-based zero handling
- Controlled rounding</p>
</dd></dl>

</section>
<section id="module-utils.token_jwt_handling">
<span id="utils-token-jwt-handling"></span><h1>utils.token_jwt_handling<a class="headerlink" href="#module-utils.token_jwt_handling" title="Link to this heading"></a></h1>
<dl class="py exception">
<dt class="sig sig-object py" id="utils.token_jwt_handling.AuthError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AuthError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">status_code</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/token_jwt_handling.html#AuthError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.token_jwt_handling.AuthError" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Custom exception class for authentication and token-related errors.</p>
<p>This class provides structured error handling for authentication operations,
including status codes for proper HTTP response handling.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="utils.token_jwt_handling.AuthError.error">
<span class="sig-name descname"><span class="pre">error</span></span><a class="headerlink" href="#utils.token_jwt_handling.AuthError.error" title="Link to this definition"></a></dt>
<dd><p>Descriptive error message</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="utils.token_jwt_handling.AuthError.status_code">
<span class="sig-name descname"><span class="pre">status_code</span></span><a class="headerlink" href="#utils.token_jwt_handling.AuthError.status_code" title="Link to this definition"></a></dt>
<dd><p>HTTP status code for the error</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="simple">
<dt>Usage:</dt><dd><p>raise AuthError(“Token expired”, 401)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="utils.token_jwt_handling.AuthError.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">status_code</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/token_jwt_handling.html#AuthError.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.token_jwt_handling.AuthError.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="utils.token_jwt_handling.TokenJWTHandling">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TokenJWTHandling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cipher</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/token_jwt_handling.html#TokenJWTHandling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.token_jwt_handling.TokenJWTHandling" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="utils.token_jwt_handling.TokenJWTHandling.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cipher</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/token_jwt_handling.html#TokenJWTHandling.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.token_jwt_handling.TokenJWTHandling.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize secure token handling with database and encryption support.</p>
<p>This constructor sets up the token management system with proper security
configuration and initializes the required dependencies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db</strong> – Firestore database instance for token storage</p></li>
<li><p><strong>cipher</strong> – AESCipher instance for data encryption/decryption</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Security Features:</dt><dd><ul class="simple">
<li><p>Protected configuration loading</p></li>
<li><p>Secure key management</p></li>
<li><p>Rate limit configuration</p></li>
<li><p>Token lifecycle settings</p></li>
</ul>
</dd>
<dt>Environment Variables:</dt><dd><p>JWT_SECRET_KEY: Secret key for token signing</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.token_jwt_handling.TokenJWTHandling.get_user_token_history">
<span class="sig-name descname"><span class="pre">get_user_token_history</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">since</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">datetime</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/utils/token_jwt_handling.html#TokenJWTHandling.get_user_token_history"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.token_jwt_handling.TokenJWTHandling.get_user_token_history" title="Link to this definition"></a></dt>
<dd><p>Retrieve a user’s token generation history with secure filtering.</p>
<p>This method securely queries the database for a user’s token history,
applying proper time-based filtering and status validation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>user_id</strong> (<em>str</em>) – Unique identifier of the user</p></li>
<li><p><strong>since</strong> (<em>datetime</em>) – Starting timestamp for history retrieval</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Filtered list of token history records</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[Dict]</p>
</dd>
</dl>
<dl class="simple">
<dt>Security:</dt><dd><ul class="simple">
<li><p>Query parameter validation</p></li>
<li><p>Status filtering</p></li>
<li><p>Time-based constraints</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.token_jwt_handling.TokenJWTHandling.check_token_request_eligibility">
<span class="sig-name descname"><span class="pre">check_token_request_eligibility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">datetime</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/utils/token_jwt_handling.html#TokenJWTHandling.check_token_request_eligibility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.token_jwt_handling.TokenJWTHandling.check_token_request_eligibility" title="Link to this definition"></a></dt>
<dd><p>Validate token request eligibility based on security policies.</p>
<p>This method implements rate limiting and cooldown periods for token
generation to prevent abuse and ensure secure token management.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>user_id</strong> (<em>str</em>) – Unique identifier of the requesting user</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Boolean indicating eligibility</p></li>
<li><p>Next eligible timestamp if applicable</p></li>
<li><p>Error message if request is denied</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[bool, Optional[datetime], Optional[str]]</p>
</dd>
</dl>
<dl class="simple">
<dt>Security:</dt><dd><ul class="simple">
<li><p>Daily limit enforcement</p></li>
<li><p>Cooldown period validation</p></li>
<li><p>Request tracking</p></li>
<li><p>Time-based restrictions</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.token_jwt_handling.TokenJWTHandling.expire_previous_tokens">
<span class="sig-name descname"><span class="pre">expire_previous_tokens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/utils/token_jwt_handling.html#TokenJWTHandling.expire_previous_tokens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.token_jwt_handling.TokenJWTHandling.expire_previous_tokens" title="Link to this definition"></a></dt>
<dd><p>Invalidate all active tokens for a user with secure state transitions.</p>
<p>This method implements secure token expiration with proper audit logging
and atomic database operations to maintain token lifecycle integrity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>user_id</strong> (<em>str</em>) – User identifier whose tokens should be expired</p>
</dd>
</dl>
<dl class="simple">
<dt>Security Features:</dt><dd><ul class="simple">
<li><p>Batch operations for atomicity</p></li>
<li><p>Secure decryption for validation</p></li>
<li><p>Status transition logging</p></li>
<li><p>Time-based validation</p></li>
<li><p>Audit trail creation</p></li>
</ul>
</dd>
<dt>Operations Flow:</dt><dd><ol class="arabic simple">
<li><p>Retrieve user’s cryptographic salt</p></li>
<li><p>Query active tokens</p></li>
<li><p>Validate and decrypt tokens</p></li>
<li><p>Batch update expired status</p></li>
<li><p>Create audit logs</p></li>
</ol>
</dd>
<dt>Protected State Transitions:</dt><dd><ul class="simple">
<li><p>Active to Expired status</p></li>
<li><p>Timestamp recording</p></li>
<li><p>Reason documentation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.token_jwt_handling.TokenJWTHandling.get_active_token">
<span class="sig-name descname"><span class="pre">get_active_token</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="_modules/utils/token_jwt_handling.html#TokenJWTHandling.get_active_token"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.token_jwt_handling.TokenJWTHandling.get_active_token" title="Link to this definition"></a></dt>
<dd><p>Retrieve the current active token for a user with validation.</p>
<p>This method securely fetches and validates the most recent active token,
performing necessary decryption and expiration checks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>user_id</strong> (<em>str</em>) – User identifier to check for active tokens</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Active token information if valid, None otherwise</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Dict[str, Any]]</p>
</dd>
</dl>
<dl class="simple">
<dt>Security Features:</dt><dd><ul class="simple">
<li><p>Salt-based decryption</p></li>
<li><p>Time-based validation</p></li>
<li><p>Status verification</p></li>
<li><p>Secure ordering</p></li>
<li><p>Query limiting</p></li>
</ul>
</dd>
<dt>Validation Checks:</dt><dd><ul class="simple">
<li><p>Token existence</p></li>
<li><p>Expiration status</p></li>
<li><p>Decryption integrity</p></li>
<li><p>Time validity</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.token_jwt_handling.TokenJWTHandling.generate_tokens">
<span class="sig-name descname"><span class="pre">generate_tokens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/utils/token_jwt_handling.html#TokenJWTHandling.generate_tokens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.token_jwt_handling.TokenJWTHandling.generate_tokens" title="Link to this definition"></a></dt>
<dd><p>Generate new JWT tokens with secure storage and rate limiting.</p>
<p>This method creates new JWT tokens with proper security measures,
including rate limiting, encryption, and secure storage operations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>user_id</strong> (<em>str</em>) – User identifier for token generation</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Generated token information including expiration and next request time</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#utils.token_jwt_handling.AuthError" title="utils.token_jwt_handling.AuthError"><strong>AuthError</strong></a> – For rate limit violations (429) or generation failures (500)</p>
</dd>
</dl>
<dl class="simple">
<dt>Security Features:</dt><dd><ul class="simple">
<li><p>Rate limit enforcement</p></li>
<li><p>Previous token expiration</p></li>
<li><p>Secure JWT creation</p></li>
<li><p>Protected storage</p></li>
<li><p>Device tracking</p></li>
</ul>
</dd>
<dt>Token Properties:</dt><dd><ul class="simple">
<li><p>Expiration time</p></li>
<li><p>Creation timestamp</p></li>
<li><p>User binding</p></li>
<li><p>Device information</p></li>
<li><p>Request cooldown</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.token_jwt_handling.TokenJWTHandling.get_token_creation_time">
<span class="sig-name descname"><span class="pre">get_token_creation_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">datetime</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="_modules/utils/token_jwt_handling.html#TokenJWTHandling.get_token_creation_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.token_jwt_handling.TokenJWTHandling.get_token_creation_time" title="Link to this definition"></a></dt>
<dd><p>Extract token creation timestamp from JWT claims securely.</p>
<p>This method safely decodes JWT claims to retrieve the token creation time
with proper error handling and validation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>token</strong> (<em>str</em>) – JWT token to analyze</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Token creation timestamp if valid, None otherwise</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[datetime]</p>
</dd>
</dl>
<dl class="simple">
<dt>Security Features:</dt><dd><ul class="simple">
<li><p>Secure JWT decoding</p></li>
<li><p>Signature validation</p></li>
<li><p>Time parsing protection</p></li>
<li><p>Error isolation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.token_jwt_handling.TokenJWTHandling.jwt_required">
<span class="sig-name descname"><span class="pre">jwt_required</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/token_jwt_handling.html#TokenJWTHandling.jwt_required"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.token_jwt_handling.TokenJWTHandling.jwt_required" title="Link to this definition"></a></dt>
<dd><p>Protect routes with comprehensive JWT validation and security checks.</p>
<p>This decorator implements complete token validation including signature verification,
database validation, and proper user session binding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>f</strong> (<em>Callable</em>) – The route function to protect</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Protected route function</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Callable</p>
</dd>
</dl>
<dl class="simple">
<dt>Security Features:</dt><dd><ul class="simple">
<li><p>Token presence validation</p></li>
<li><p>JWT signature verification</p></li>
<li><p>Database token validation</p></li>
<li><p>Expiration checking</p></li>
<li><p>User session binding</p></li>
<li><p>Error logging</p></li>
</ul>
</dd>
<dt>Validation Flow:</dt><dd><ol class="arabic simple">
<li><p>Token format verification</p></li>
<li><p>JWT signature validation</p></li>
<li><p>Token type checking</p></li>
<li><p>Database record validation</p></li>
<li><p>Expiration verification</p></li>
<li><p>User session binding</p></li>
</ol>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#utils.token_jwt_handling.AuthError" title="utils.token_jwt_handling.AuthError"><strong>AuthError</strong></a> – Various 401 status codes for different validation failures
    - Missing token
    - Invalid signature
    - Token not found
    - Token expired
    - Verification failed</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Link to this heading"></a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>